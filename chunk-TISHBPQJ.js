import{a as n,b as r,f as u,p as d}from"./chunk-KKTR3JM6.js";var p=(()=>{let o=class o{constructor(){this.notificationsSubject=new u([]),this.notifications$=this.notificationsSubject.asObservable(),this.loadNotifications()}loadNotifications(){let t=localStorage.getItem("notificaciones");if(t)try{let i=JSON.parse(t).map(a=>r(n({},a),{timestamp:new Date(a.timestamp)}));this.notificationsSubject.next(i)}catch(i){console.error("Error al cargar notificaciones:",i)}}saveNotifications(){let t=this.notificationsSubject.value;localStorage.setItem("notificaciones",JSON.stringify(t))}generateId(){return`notif-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}formatTimeAgo(t){let a=new Date().getTime()-t.getTime(),e=Math.floor(a/1e3),s=Math.floor(e/60),c=Math.floor(s/60),f=Math.floor(c/24);return e<60?"Hace unos segundos":s<60?`Hace ${s} min`:c<24?`Hace ${c} ${c===1?"hora":"horas"}`:f===1?"Ayer":f<7?`Hace ${f} d\xEDas`:t.toLocaleDateString("es-PE",{day:"numeric",month:"short"})}addNotification(t){let i=n({id:this.generateId(),timestamp:new Date,read:!1},t),a=this.notificationsSubject.value,e=[i,...a].slice(0,50);this.notificationsSubject.next(e),this.saveNotifications()}notificarPlanillaGenerada(t,i){this.addNotification({icon:"\u2705",title:"Planilla generada",message:`Planilla ${t} (${i}) generada exitosamente`,type:"success",actionUrl:"/planillas/historial"})}notificarPlanillaAprobada(t,i){this.addNotification({icon:"\u2705",title:"Planilla aprobada",message:`Planilla ${t} (${i}) aprobada exitosamente`,type:"success",actionUrl:"/planillas/historial"})}notificarPlanillaPagada(t,i){this.addNotification({icon:"\u{1F4B3}",title:"Planilla pagada",message:`Planilla ${t} (${i}) marcada como pagada`,type:"success",actionUrl:"/planillas/historial"})}getNotifications(){return this.notificationsSubject.value}getUnreadCount(){return this.notificationsSubject.value.filter(t=>!t.read).length}markAsRead(t){let a=this.notificationsSubject.value.map(e=>e.id===t?r(n({},e),{read:!0}):e);this.notificationsSubject.next(a),this.saveNotifications()}markAllAsRead(){let i=this.notificationsSubject.value.map(a=>r(n({},a),{read:!0}));this.notificationsSubject.next(i),this.saveNotifications()}deleteNotification(t){let a=this.notificationsSubject.value.filter(e=>e.id!==t);this.notificationsSubject.next(a),this.saveNotifications()}clearAll(){this.notificationsSubject.next([]),this.saveNotifications()}getTimeAgo(t){return this.formatTimeAgo(t.timestamp)}};o.\u0275fac=function(i){return new(i||o)},o.\u0275prov=d({token:o,factory:o.\u0275fac,providedIn:"root"});let l=o;return l})();export{p as a};
