import{c as Z,d as W,f as L,i as B}from"./chunk-TF6RCWTO.js";import{a as q}from"./chunk-MPWYS2KC.js";import{Ca as N,Eb as re,Fa as r,Ga as x,Ha as z,I as G,Ib as se,Ja as X,K,L as s,La as E,Ma as w,Na as T,Rb as ce,T as H,Ub as le,V as Q,Xb as de,Zb as me,_ as O,a as V,b as U,bc as pe,cc as ge,dc as fe,ec as _e,fa as _,fc as ue,ga as n,gb as ee,gc as he,ha as o,ia as I,kc as be,lb as te,mb as ae,nb as ne,pa as j,sa as b,ta as m,tb as ie,v as p,w as g,zb as oe}from"./chunk-KKTR3JM6.js";var xe={horaEntradaManana:"08:00",horaSalidaManana:"13:00",horaEntradaTarde:"14:00",horaSalidaTarde:"17:00",minutosTolerancia:15,minutosMaximoRetraso:60},Me=["Cita M\xE9dica","Emergencia Familiar","Tr\xE1mite Personal","Capacitaci\xF3n","Comisi\xF3n de Servicio","Permiso Sindical","Licencia por Enfermedad","Licencia por Maternidad","Licencia por Paternidad","Vacaciones","Otro"];function ve(l,h){if(l&1&&(n(0,"div",55)(1,"div",56)(2,"div",57),r(3,"\u{1F465}"),o(),n(4,"div",58)(5,"span",59),r(6,"Total Trabajadores"),o(),n(7,"span",60),r(8),o()()(),n(9,"div",61)(10,"div",57),r(11,"\u2705"),o(),n(12,"div",58)(13,"span",59),r(14,"Presentes"),o(),n(15,"span",60),r(16),o()()(),n(17,"div",62)(18,"div",57),r(19,"\u23F0"),o(),n(20,"div",58)(21,"span",59),r(22,"Tardanzas"),o(),n(23,"span",60),r(24),o()()(),n(25,"div",63)(26,"div",57),r(27,"\u274C"),o(),n(28,"div",58)(29,"span",59),r(30,"Faltas"),o(),n(31,"span",60),r(32),o()()(),n(33,"div",64)(34,"div",57),r(35,"\u{1F4C4}"),o(),n(36,"div",58)(37,"span",59),r(38,"Permisos"),o(),n(39,"span",60),r(40),o()()(),n(41,"div",65)(42,"div",57),r(43,"\u{1F3E5}"),o(),n(44,"div",58)(45,"span",59),r(46,"Licencias"),o(),n(47,"span",60),r(48),o()()(),n(49,"div",66)(50,"div",57),r(51,"\u{1F4CA}"),o(),n(52,"div",58)(53,"span",59),r(54,"% Asistencia"),o(),n(55,"span",60),r(56),o()()()()),l&2){let a=m();s(8),x(a.resumenDiario.totalTrabajadores),s(8),x(a.resumenDiario.presentes),s(8),x(a.resumenDiario.tardanzas),s(8),x(a.resumenDiario.faltas),s(8),x(a.resumenDiario.permisos),s(8),x(a.resumenDiario.licencias),s(8),z("",a.resumenDiario.porcentajeAsistencia,"%")}}function Ce(l,h){l&1&&(n(0,"span"),r(1,"\u2705 Marcar Todos Presentes"),o())}function Se(l,h){l&1&&(n(0,"span"),r(1,"\u274C Marcar Todos como Falta"),o())}function Pe(l,h){if(l&1&&(n(0,"option",67),r(1),o()),l&2){let a=h.$implicit;_("value",a),s(),x(a)}}function Ee(l,h){if(l&1&&(n(0,"option",67),r(1),o()),l&2){let a=h.$implicit;_("value",a.Nombre),s(),x(a.Nombre)}}function we(l,h){if(l&1){let a=j();n(0,"button",68),b("click",function(){p(a);let e=m();return g(e.limpiarFiltros())}),r(1," \u2716\uFE0F Limpiar "),o()}}function Te(l,h){l&1&&(n(0,"tr")(1,"td",73)(2,"div",74),r(3,"Cargando..."),o()()())}function ye(l,h){l&1&&(n(0,"tr")(1,"td",75)(2,"div",76)(3,"span",77),r(4,"\u{1F4ED}"),o(),n(5,"p",78),r(6,"No se encontraron registros"),o()()()())}function Oe(l,h){if(l&1&&(n(0,"span",104),r(1),o()),l&2){let a=m().$implicit;s(),z(" +",a.minutosTardanza,"min ")}}function ke(l,h){if(l&1&&(n(0,"span",105),r(1),o()),l&2){let a=m().$implicit;s(),z("+",a.horasExtras," extra")}}function je(l,h){l&1&&(n(0,"span",106),r(1," \u2705 "),o())}function Re(l,h){l&1&&(n(0,"span",107),r(1," \u26A0\uFE0F "),o())}function De(l,h){if(l&1){let a=j();n(0,"button",108),b("click",function(e){p(a);let i=m().$implicit;return m(2).marcarPresente(i),g(e.stopPropagation())}),r(1," \u2705 "),o()}}function Ae(l,h){if(l&1){let a=j();n(0,"button",109),b("click",function(e){p(a);let i=m().$implicit;return m(2).marcarFalta(i),g(e.stopPropagation())}),r(1," \u274C "),o()}}function Ie(l,h){if(l&1){let a=j();n(0,"button",110),b("click",function(e){p(a);let i=m().$implicit;return m(2).abrirModalTardanza(i),g(e.stopPropagation())}),r(1," \u23F0 "),o()}}function ze(l,h){if(l&1){let a=j();n(0,"button",111),b("click",function(e){p(a);let i=m().$implicit;return m(2).abrirModalPermiso(i),g(e.stopPropagation())}),r(1," \u{1F4CB} "),o()}}function Fe(l,h){if(l&1){let a=j();n(0,"button",112),b("click",function(e){p(a);let i=m().$implicit;return m(2).abrirModalLicencia(i),g(e.stopPropagation())}),r(1," \u{1F3E5} "),o()}}function Ve(l,h){if(l&1){let a=j();n(0,"tr")(1,"td",79),r(2),o(),n(3,"td",80)(4,"div",81)(5,"span",82),r(6),o(),n(7,"span",83),r(8),o()()(),n(9,"td",84),r(10),o(),n(11,"td",85),r(12),O(13,Oe,2,1,"span",86),o(),n(14,"td",85),r(15),o(),n(16,"td",85),r(17),o(),n(18,"td",85),r(19),o(),n(20,"td",87)(21,"span",88),r(22),o()(),n(23,"td",89)(24,"span",90),r(25),o(),O(26,ke,2,1,"span",91),o(),n(27,"td",92),O(28,je,2,0,"span",93)(29,Re,2,0,"span",94),o(),n(30,"td",95)(31,"div",96),O(32,De,2,0,"button",97)(33,Ae,2,0,"button",98)(34,Ie,2,0,"button",99)(35,ze,2,0,"button",100)(36,Fe,2,0,"button",101),n(37,"button",102),b("click",function(e){let i=p(a).$implicit;return m(2).abrirModalEdicion(i),g(e.stopPropagation())}),r(38," \u2699\uFE0F "),o(),n(39,"button",103),b("click",function(e){let i=p(a).$implicit;return m(2).abrirModalJustificacion(i),g(e.stopPropagation())}),r(40," \u{1F4DD} "),o()()()()}if(l&2){let a=h.$implicit,t=m(2);N("highlight",a.estado==="Falta")("dia-no-habil",t.esDiaNoHabil()),s(2),x(a.trabajadorDni),s(4),x(a.trabajadorNombre),s(2),x(a.trabajadorCargo),s(2),x(a.trabajadorArea),s(),N("td-hora--retraso",a.minutosTardanza>0),s(),z(" ",a.horaEntradaManana&&a.horaEntradaManana!=="---"&&a.horaEntradaManana!=="--:--"?a.horaEntradaManana:a.horarioAsignadoEntradaManana||"---"," "),s(),_("ngIf",a.minutosTardanza>0),s(2),x(a.horaSalidaManana&&a.horaSalidaManana!=="---"&&a.horaSalidaManana!=="--:--"?a.horaSalidaManana:a.horarioAsignadoSalidaManana||"---"),s(2),x(a.horaEntradaTarde&&a.horaEntradaTarde!=="---"&&a.horaEntradaTarde!=="--:--"?a.horaEntradaTarde:a.horarioAsignadoEntradaTarde||"---"),s(2),x(a.horaSalidaTarde&&a.horaSalidaTarde!=="---"&&a.horaSalidaTarde!=="--:--"?a.horaSalidaTarde:a.horarioAsignadoSalidaTarde||"---"),s(2),_("ngClass",t.getEstadoBadgeClass(a.estado)),s(),z(" ",a.estado," "),s(3),x(a.tiempoTrabajado),s(),_("ngIf",a.horasExtras&&a.horasExtras!=="0h"),s(2),_("ngIf",a.tieneJustificacion),s(),_("ngIf",!a.tieneJustificacion&&a.estado!=="Presente"),s(3),_("ngIf",a.estado==="Falta"||a.tipoMarcacion==="Falta"),s(),_("ngIf",a.tipoMarcacion!=="Falta"&&a.tipoMarcacion!=="Permiso"&&a.tipoMarcacion!=="Licencia"),s(),_("ngIf",a.tipoMarcacion!=="Tardanza"),s(),_("ngIf",a.tipoMarcacion!=="Permiso"),s(),_("ngIf",a.tipoMarcacion!=="Licencia")}}function Ne(l,h){if(l&1&&(n(0,"div",69)(1,"div",70)(2,"table",71)(3,"thead")(4,"tr")(5,"th"),r(6,"DNI"),o(),n(7,"th"),r(8,"Trabajador"),o(),n(9,"th"),r(10,"\xC1rea"),o(),n(11,"th"),r(12,"Entrada Ma\xF1ana"),o(),n(13,"th"),r(14,"Salida Ma\xF1ana"),o(),n(15,"th"),r(16,"Entrada Tarde"),o(),n(17,"th"),r(18,"Salida Tarde"),o(),n(19,"th"),r(20,"Estado"),o(),n(21,"th"),r(22,"Tiempo Trabajado"),o(),n(23,"th"),r(24,"Justificaci\xF3n"),o(),n(25,"th"),r(26,"Acciones"),o()()(),n(27,"tbody"),O(28,Te,4,0,"tr",33)(29,ye,7,0,"tr",33)(30,Ve,41,26,"tr",72),o()()()()),l&2){let a=m();s(28),_("ngIf",a.cargando),s(),_("ngIf",!a.cargando&&a.registrosFiltrados.length===0),s(),_("ngForOf",a.registrosFiltrados)}}function Le(l,h){if(l&1&&(n(0,"div",129)(1,"span",130),r(2,"\u23F0"),o(),n(3,"div",131)(4,"span",132),r(5,"Retraso"),o(),n(6,"span",133),r(7),o()()()),l&2){let a=m().$implicit;s(7),z("",a.minutosTardanza,"min")}}function He(l,h){if(l&1&&(n(0,"div",129)(1,"span",130),r(2,"\u2B50"),o(),n(3,"div",131)(4,"span",132),r(5,"Horas Extra"),o(),n(6,"span",133),r(7),o()()()),l&2){let a=m().$implicit;s(7),x(a.horasExtras)}}function We(l,h){if(l&1&&(n(0,"div",143)(1,"span",144),r(2,"\u{1F4CB}"),o(),n(3,"div",145)(4,"span",146),r(5,"Justificaci\xF3n:"),o(),n(6,"span",147),r(7),o()()()),l&2){let a=m().$implicit;s(7),x(a.motivoJustificacion)}}function Be(l,h){if(l&1&&(n(0,"div",148)(1,"span",149),r(2,"\u{1F4AC}"),o(),n(3,"span",150),r(4),o()()),l&2){let a=m().$implicit;s(4),x(a.observaciones)}}function $e(l,h){if(l&1){let a=j();n(0,"button",151),b("click",function(){p(a);let e=m().$implicit,i=m(2);return g(i.marcarPresente(e))}),r(1," \u2705 Marcar Presente "),o()}}function Je(l,h){if(l&1){let a=j();n(0,"button",152),b("click",function(){p(a);let e=m().$implicit,i=m(2);return g(i.marcarFalta(e))}),r(1," \u274C Marcar Falta "),o()}}function qe(l,h){if(l&1){let a=j();n(0,"div",115)(1,"div",116)(2,"div",117)(3,"div",118),r(4),o(),n(5,"div",119)(6,"h4",120),r(7),o(),n(8,"p",121),r(9),o(),n(10,"p",122),r(11),o()()(),n(12,"span",88),r(13),o()(),n(14,"div",123)(15,"div",124)(16,"div",125)(17,"span",126),r(18,"\u{1F305} Entrada Ma\xF1ana"),o(),n(19,"span",127),r(20),o()(),n(21,"div",125)(22,"span",126),r(23,"\u{1F304} Salida Ma\xF1ana"),o(),n(24,"span",127),r(25),o()(),n(26,"div",125)(27,"span",126),r(28,"\u{1F306} Entrada Tarde"),o(),n(29,"span",127),r(30),o()(),n(31,"div",125)(32,"span",126),r(33,"\u{1F303} Salida Tarde"),o(),n(34,"span",127),r(35),o()()(),n(36,"div",128)(37,"div",129)(38,"span",130),r(39,"\u23F1\uFE0F"),o(),n(40,"div",131)(41,"span",132),r(42,"Horas Trabajadas"),o(),n(43,"span",133),r(44),o()()(),O(45,Le,8,1,"div",134)(46,He,8,1,"div",134),o(),O(47,We,8,1,"div",135)(48,Be,5,1,"div",136),o(),n(49,"div",137)(50,"div",138),O(51,$e,2,0,"button",139)(52,Je,2,0,"button",140),n(53,"button",31),b("click",function(){let e=p(a).$implicit,i=m(2);return g(i.abrirModalEdicion(e))}),r(54," \u23F0 Editar "),o(),n(55,"button",141),b("click",function(){let e=p(a).$implicit,i=m(2);return g(i.abrirModalJustificacion(e))}),r(56," \u{1F4DD} Justificar "),o()(),n(57,"span",142),r(58),o()()()}if(l&2){let a=h.$implicit,t=m(2);N("tarjeta-asistencia--falta",a.estado==="Falta"),s(4),x(a.trabajadorNombre.charAt(0)),s(3),x(a.trabajadorNombre),s(2),x(a.trabajadorCargo),s(2),x(a.trabajadorArea),s(),_("ngClass",t.getEstadoBadgeClass(a.estado)),s(),z(" ",a.estado," "),s(7),x(a.horaEntradaManana||"---"),s(5),x(a.horaSalidaManana||"---"),s(5),x(a.horaEntradaTarde||"---"),s(5),x(a.horaSalidaTarde||"---"),s(9),x(a.tiempoTrabajado),s(),_("ngIf",a.minutosTardanza>0),s(),_("ngIf",a.horasExtras&&a.horasExtras!=="0h"),s(),_("ngIf",a.tieneJustificacion),s(),_("ngIf",a.observaciones),s(3),_("ngIf",a.estado==="Falta"),s(),_("ngIf",a.estado!=="Falta"),s(6),x(a.tipoMarcacion)}}function Ye(l,h){if(l&1&&(n(0,"div",113),O(1,qe,59,20,"div",114),o()),l&2){let a=m();s(),_("ngForOf",a.registrosFiltrados)}}function Ue(l,h){if(l&1&&(n(0,"option",67),r(1),o()),l&2){let a=h.$implicit;_("value",a.id),s(),X(" ",a.nombreCompleto," - ",a.dni," (",a.area,") ")}}function Ge(l,h){if(l&1){let a=j();n(0,"div",153),b("click",function(){p(a);let e=m();return e.mostrarModalRegistro=!1,g(e.restaurarTopbarSidebar())}),n(1,"div",154),b("click",function(e){return p(a),g(e.stopPropagation())}),n(2,"div",155)(3,"h3",156),r(4,"\u{1F4DD} Registro Manual de Asistencia"),o(),n(5,"button",157),b("click",function(){p(a);let e=m();return e.mostrarModalRegistro=!1,g(e.restaurarTopbarSidebar())}),r(6,"\u2716\uFE0F"),o()(),n(7,"div",158)(8,"p",159),r(9,"Registrar asistencia manualmente para trabajadores sin marcaci\xF3n biom\xE9trica"),o(),n(10,"div",160)(11,"div",161)(12,"label",162),r(13,"Trabajador *"),o(),n(14,"select",163),T("ngModelChange",function(e){p(a);let i=m();return w(i.formularioRegistro.trabajadorId,e)||(i.formularioRegistro.trabajadorId=e),g(e)}),n(15,"option",42),r(16,"Seleccione un trabajador"),o(),O(17,Ue,2,4,"option",43),o()(),n(18,"div",164)(19,"label",162),r(20,"Hora Entrada Ma\xF1ana"),o(),n(21,"input",165),T("ngModelChange",function(e){p(a);let i=m();return w(i.formularioRegistro.horaEntradaManana,e)||(i.formularioRegistro.horaEntradaManana=e),g(e)}),o()(),n(22,"div",164)(23,"label",162),r(24,"Hora Salida Ma\xF1ana"),o(),n(25,"input",165),T("ngModelChange",function(e){p(a);let i=m();return w(i.formularioRegistro.horaSalidaManana,e)||(i.formularioRegistro.horaSalidaManana=e),g(e)}),o()(),n(26,"div",164)(27,"label",162),r(28,"Hora Entrada Tarde"),o(),n(29,"input",165),T("ngModelChange",function(e){p(a);let i=m();return w(i.formularioRegistro.horaEntradaTarde,e)||(i.formularioRegistro.horaEntradaTarde=e),g(e)}),o()(),n(30,"div",164)(31,"label",162),r(32,"Hora Salida Tarde"),o(),n(33,"input",165),T("ngModelChange",function(e){p(a);let i=m();return w(i.formularioRegistro.horaSalidaTarde,e)||(i.formularioRegistro.horaSalidaTarde=e),g(e)}),o()(),n(34,"div",161)(35,"label",162),r(36,"Tipo de Marcaci\xF3n *"),o(),n(37,"select",163),T("ngModelChange",function(e){p(a);let i=m();return w(i.formularioRegistro.tipoMarcacion,e)||(i.formularioRegistro.tipoMarcacion=e),g(e)}),n(38,"option",166),r(39,"Presente"),o(),n(40,"option",167),r(41,"Tardanza"),o(),n(42,"option",168),r(43,"Falta"),o(),n(44,"option",169),r(45,"Permiso"),o(),n(46,"option",170),r(47,"Licencia"),o(),n(48,"option",171),r(49,"Vacaciones"),o(),n(50,"option",172),r(51,"Comisi\xF3n de Servicio"),o()()(),n(52,"div",161)(53,"label",162),r(54,"Justificaci\xF3n"),o(),n(55,"textarea",173),T("ngModelChange",function(e){p(a);let i=m();return w(i.formularioRegistro.justificacion,e)||(i.formularioRegistro.justificacion=e),g(e)}),o()(),n(56,"div",161)(57,"label",162),r(58,"Observaciones"),o(),I(59,"textarea",174),o()()(),n(60,"div",175)(61,"button",176),b("click",function(){p(a);let e=m();return e.mostrarModalRegistro=!1,g(e.restaurarTopbarSidebar())}),r(62,"Cancelar"),o(),n(63,"button",177),b("click",function(){p(a);let e=m();return g(e.registrarAsistenciaManual())}),r(64,"\u{1F4BE} Guardar Registro"),o()()()()}if(l&2){let a=m();s(14),E("ngModel",a.formularioRegistro.trabajadorId),s(3),_("ngForOf",a.trabajadoresActivos),s(4),E("ngModel",a.formularioRegistro.horaEntradaManana),s(4),E("ngModel",a.formularioRegistro.horaSalidaManana),s(4),E("ngModel",a.formularioRegistro.horaEntradaTarde),s(4),E("ngModel",a.formularioRegistro.horaSalidaTarde),s(4),E("ngModel",a.formularioRegistro.tipoMarcacion),s(18),E("ngModel",a.formularioRegistro.justificacion)}}function Xe(l,h){if(l&1){let a=j();n(0,"div",158)(1,"div",179)(2,"div",118),r(3),o(),n(4,"div",119)(5,"h4"),r(6),o(),n(7,"p"),r(8),o()(),n(9,"span",88),r(10),o()(),n(11,"div",160)(12,"div",164)(13,"label",162),r(14,"\u{1F305} Entrada Ma\xF1ana"),o(),n(15,"input",165),T("ngModelChange",function(e){p(a);let i=m(2);return w(i.registroSeleccionado.horaEntradaManana,e)||(i.registroSeleccionado.horaEntradaManana=e),g(e)}),o()(),n(16,"div",164)(17,"label",162),r(18,"\u{1F304} Salida Ma\xF1ana"),o(),n(19,"input",165),T("ngModelChange",function(e){p(a);let i=m(2);return w(i.registroSeleccionado.horaSalidaManana,e)||(i.registroSeleccionado.horaSalidaManana=e),g(e)}),o()(),n(20,"div",164)(21,"label",162),r(22,"\u{1F306} Entrada Tarde"),o(),n(23,"input",165),T("ngModelChange",function(e){p(a);let i=m(2);return w(i.registroSeleccionado.horaEntradaTarde,e)||(i.registroSeleccionado.horaEntradaTarde=e),g(e)}),o()(),n(24,"div",164)(25,"label",162),r(26,"\u{1F303} Salida Tarde"),o(),n(27,"input",165),T("ngModelChange",function(e){p(a);let i=m(2);return w(i.registroSeleccionado.horaSalidaTarde,e)||(i.registroSeleccionado.horaSalidaTarde=e),g(e)}),o()(),n(28,"div",161)(29,"label",162),r(30,"Estado"),o(),n(31,"select",180),T("ngModelChange",function(e){p(a);let i=m(2);return w(i.registroSeleccionado.estado,e)||(i.registroSeleccionado.estado=e),g(e)}),n(32,"option",166),r(33,"\u2705 Presente"),o(),n(34,"option",167),r(35,"\u23F0 Tardanza"),o(),n(36,"option",168),r(37,"\u274C Falta"),o(),n(38,"option",169),r(39,"\u{1F4C4} Permiso"),o(),n(40,"option",170),r(41,"\u{1F3E5} Licencia"),o(),n(42,"option",171),r(43,"\u{1F3D6}\uFE0F Vacaciones"),o(),n(44,"option",172),r(45,"\u{1F697} Comisi\xF3n"),o()()(),n(46,"div",161)(47,"label",162),r(48,"Observaciones"),o(),n(49,"textarea",181),T("ngModelChange",function(e){p(a);let i=m(2);return w(i.registroSeleccionado.observaciones,e)||(i.registroSeleccionado.observaciones=e),g(e)}),o()()()()}if(l&2){let a=m(2);s(3),x(a.registroSeleccionado.trabajadorNombre.charAt(0)),s(3),x(a.registroSeleccionado.trabajadorNombre),s(2),x(a.registroSeleccionado.trabajadorArea),s(),_("ngClass",a.getEstadoBadgeClass(a.registroSeleccionado.estado)),s(),z(" ",a.registroSeleccionado.estado," "),s(5),E("ngModel",a.registroSeleccionado.horaEntradaManana),s(4),E("ngModel",a.registroSeleccionado.horaSalidaManana),s(4),E("ngModel",a.registroSeleccionado.horaEntradaTarde),s(4),E("ngModel",a.registroSeleccionado.horaSalidaTarde),s(4),E("ngModel",a.registroSeleccionado.estado),s(18),E("ngModel",a.registroSeleccionado.observaciones)}}function Ze(l,h){if(l&1){let a=j();n(0,"div",153),b("click",function(){p(a);let e=m();return g(e.mostrarModalEdicion=!1)}),n(1,"div",154),b("click",function(e){return p(a),g(e.stopPropagation())}),n(2,"div",155)(3,"h3",156),r(4,"\u23F0 Editar Horarios de Asistencia"),o(),n(5,"button",157),b("click",function(){p(a);let e=m();return g(e.mostrarModalEdicion=!1)}),r(6,"\u2716\uFE0F"),o()(),O(7,Xe,50,11,"div",178),n(8,"div",175)(9,"button",176),b("click",function(){p(a);let e=m();return g(e.mostrarModalEdicion=!1)}),r(10,"Cancelar"),o(),n(11,"button",177),b("click",function(){p(a);let e=m();return g(e.guardarEdicion())}),r(12,"\u{1F4BE} Guardar Cambios"),o()()()()}if(l&2){let a=m();s(7),_("ngIf",a.registroSeleccionado)}}function Ke(l,h){if(l&1&&(n(0,"option",67),r(1),o()),l&2){let a=h.$implicit;_("value",a),s(),x(a)}}function Qe(l,h){if(l&1){let a=j();n(0,"div",158)(1,"div",179)(2,"div",118),r(3),o(),n(4,"div",119)(5,"h4"),r(6),o(),n(7,"p"),r(8),o()(),n(9,"span",88),r(10),o()(),n(11,"div",160)(12,"div",161)(13,"label",162),r(14,"Tipo de Justificaci\xF3n"),o(),n(15,"select",180),T("ngModelChange",function(e){p(a);let i=m(2);return w(i.registroSeleccionado.motivoJustificacion,e)||(i.registroSeleccionado.motivoJustificacion=e),g(e)}),n(16,"option",42),r(17,"Seleccione un motivo"),o(),O(18,Ke,2,2,"option",43),o()(),n(19,"div",161)(20,"label",162),r(21,"Documento de Sustento"),o(),I(22,"input",183),n(23,"span",184),r(24,"Adjunte certificado m\xE9dico, papeleta de permiso, etc."),o()(),n(25,"div",161)(26,"label",162),r(27,"Observaciones"),o(),I(28,"textarea",185),o()()()}if(l&2){let a=m(2);s(3),x(a.registroSeleccionado.trabajadorNombre.charAt(0)),s(3),x(a.registroSeleccionado.trabajadorNombre),s(2),x(a.registroSeleccionado.trabajadorArea),s(),_("ngClass",a.getEstadoBadgeClass(a.registroSeleccionado.estado)),s(),z(" ",a.registroSeleccionado.estado," "),s(5),E("ngModel",a.registroSeleccionado.motivoJustificacion),s(3),_("ngForOf",a.tiposJustificacion)}}function et(l,h){if(l&1){let a=j();n(0,"div",153),b("click",function(){p(a);let e=m();return g(e.mostrarModalJustificacion=!1)}),n(1,"div",154),b("click",function(e){return p(a),g(e.stopPropagation())}),n(2,"div",155)(3,"h3",156),r(4,"\u{1F4CB} Justificaci\xF3n de Asistencia"),o(),n(5,"button",157),b("click",function(){p(a);let e=m();return g(e.mostrarModalJustificacion=!1)}),r(6,"\u2716\uFE0F"),o()(),O(7,Qe,29,7,"div",178),n(8,"div",175)(9,"button",176),b("click",function(){p(a);let e=m();return g(e.mostrarModalJustificacion=!1)}),r(10,"Cancelar"),o(),n(11,"button",182),b("click",function(){p(a);let e=m();return g(e.guardarJustificacion())}),r(12,"\u2705 Guardar Justificaci\xF3n"),o()()()()}if(l&2){let a=m();s(7),_("ngIf",a.registroSeleccionado)}}function tt(l,h){if(l&1){let a=j();n(0,"div",158)(1,"div",179)(2,"div",118),r(3),o(),n(4,"div",119)(5,"h4"),r(6),o(),n(7,"p"),r(8),o(),n(9,"p"),r(10),o()()(),n(11,"div",160)(12,"div",164)(13,"label",162),r(14,"Hora de Entrada Real"),o(),n(15,"input",187),T("ngModelChange",function(e){p(a);let i=m(2);return w(i.formTardanza.horaEntradaManana,e)||(i.formTardanza.horaEntradaManana=e),g(e)}),o()(),n(16,"div",164)(17,"label",162),r(18,"Minutos de Retraso"),o(),n(19,"input",188),T("ngModelChange",function(e){p(a);let i=m(2);return w(i.formTardanza.minutosRetraso,e)||(i.formTardanza.minutosRetraso=e),g(e)}),o()(),n(20,"div",161)(21,"label",162),r(22,"Observaciones"),o(),n(23,"textarea",189),T("ngModelChange",function(e){p(a);let i=m(2);return w(i.formTardanza.observaciones,e)||(i.formTardanza.observaciones=e),g(e)}),o()()()()}if(l&2){let a=m(2);s(3),x(a.registroSeleccionado.trabajadorNombre.charAt(0)),s(3),x(a.registroSeleccionado.trabajadorNombre),s(2),x(a.registroSeleccionado.trabajadorCargo),s(2),x(a.registroSeleccionado.trabajadorArea),s(5),E("ngModel",a.formTardanza.horaEntradaManana),s(4),E("ngModel",a.formTardanza.minutosRetraso),s(4),E("ngModel",a.formTardanza.observaciones)}}function at(l,h){if(l&1){let a=j();n(0,"div",153),b("click",function(){p(a);let e=m();return g(e.mostrarModalTardanza=!1)}),n(1,"div",154),b("click",function(e){return p(a),g(e.stopPropagation())}),n(2,"div",155)(3,"h3",156),r(4,"\u23F0 Registrar Tardanza"),o(),n(5,"button",157),b("click",function(){p(a);let e=m();return g(e.mostrarModalTardanza=!1)}),r(6,"\u2716\uFE0F"),o()(),O(7,tt,24,7,"div",178),n(8,"div",175)(9,"button",176),b("click",function(){p(a);let e=m();return g(e.mostrarModalTardanza=!1)}),r(10,"Cancelar"),o(),n(11,"button",186),b("click",function(){p(a);let e=m();return g(e.guardarTardanza())}),r(12,"\u23F0 Guardar Tardanza"),o()()()()}if(l&2){let a=m();s(7),_("ngIf",a.registroSeleccionado)}}function nt(l,h){if(l&1){let a=j();n(0,"div",164)(1,"label",162),r(2,"Horas de Permiso"),o(),n(3,"input",197),T("ngModelChange",function(e){p(a);let i=m(3);return w(i.formPermiso.horas,e)||(i.formPermiso.horas=e),g(e)}),o()()}if(l&2){let a=m(3);s(3),E("ngModel",a.formPermiso.horas)}}function it(l,h){if(l&1){let a=j();n(0,"div",158)(1,"div",179)(2,"div",118),r(3),o(),n(4,"div",119)(5,"h4"),r(6),o(),n(7,"p"),r(8),o(),n(9,"p"),r(10),o()()(),n(11,"div",160)(12,"div",164)(13,"label",162),r(14,"Tipo de Permiso"),o(),n(15,"select",180),T("ngModelChange",function(e){p(a);let i=m(2);return w(i.formPermiso.tipoPermiso,e)||(i.formPermiso.tipoPermiso=e),g(e)}),n(16,"option",191),r(17,"Medio d\xEDa"),o(),n(18,"option",192),r(19,"Todo el d\xEDa"),o(),n(20,"option",193),r(21,"Horas espec\xEDficas"),o()()(),O(22,nt,4,1,"div",194),n(23,"div",161)(24,"label",162),r(25,"Motivo del Permiso *"),o(),n(26,"input",195),T("ngModelChange",function(e){p(a);let i=m(2);return w(i.formPermiso.motivo,e)||(i.formPermiso.motivo=e),g(e)}),o()(),n(27,"div",161)(28,"label",162),r(29,"Observaciones"),o(),n(30,"textarea",196),T("ngModelChange",function(e){p(a);let i=m(2);return w(i.formPermiso.observaciones,e)||(i.formPermiso.observaciones=e),g(e)}),o()()()()}if(l&2){let a=m(2);s(3),x(a.registroSeleccionado.trabajadorNombre.charAt(0)),s(3),x(a.registroSeleccionado.trabajadorNombre),s(2),x(a.registroSeleccionado.trabajadorCargo),s(2),x(a.registroSeleccionado.trabajadorArea),s(5),E("ngModel",a.formPermiso.tipoPermiso),s(7),_("ngIf",a.formPermiso.tipoPermiso==="Horas espec\xEDficas"),s(4),E("ngModel",a.formPermiso.motivo),s(4),E("ngModel",a.formPermiso.observaciones)}}function ot(l,h){if(l&1){let a=j();n(0,"div",153),b("click",function(){p(a);let e=m();return g(e.mostrarModalPermiso=!1)}),n(1,"div",154),b("click",function(e){return p(a),g(e.stopPropagation())}),n(2,"div",155)(3,"h3",156),r(4,"\u{1F4CB} Registrar Permiso"),o(),n(5,"button",157),b("click",function(){p(a);let e=m();return g(e.mostrarModalPermiso=!1)}),r(6,"\u2716\uFE0F"),o()(),O(7,it,31,8,"div",178),n(8,"div",175)(9,"button",176),b("click",function(){p(a);let e=m();return g(e.mostrarModalPermiso=!1)}),r(10,"Cancelar"),o(),n(11,"button",190),b("click",function(){p(a);let e=m();return g(e.guardarPermiso())}),r(12,"\u{1F4CB} Guardar Permiso"),o()()()()}if(l&2){let a=m();s(7),_("ngIf",a.registroSeleccionado)}}function rt(l,h){if(l&1){let a=j();n(0,"div",158)(1,"div",179)(2,"div",118),r(3),o(),n(4,"div",119)(5,"h4"),r(6),o(),n(7,"p"),r(8),o(),n(9,"p"),r(10),o()()(),n(11,"div",160)(12,"div",164)(13,"label",162),r(14,"Tipo de Licencia"),o(),n(15,"select",180),T("ngModelChange",function(e){p(a);let i=m(2);return w(i.formLicencia.tipoLicencia,e)||(i.formLicencia.tipoLicencia=e),g(e)}),n(16,"option",199),r(17,"Con goce de haber"),o(),n(18,"option",200),r(19,"Sin goce de haber"),o(),n(20,"option",201),r(21,"Licencia m\xE9dica"),o(),n(22,"option",202),r(23,"Licencia por maternidad"),o(),n(24,"option",203),r(25,"Licencia por paternidad"),o()()(),n(26,"div",164)(27,"label",162),r(28,"D\xEDas de Licencia"),o(),n(29,"input",204),T("ngModelChange",function(e){p(a);let i=m(2);return w(i.formLicencia.dias,e)||(i.formLicencia.dias=e),g(e)}),o()(),n(30,"div",161)(31,"label",162),r(32,"Motivo de la Licencia *"),o(),n(33,"input",205),T("ngModelChange",function(e){p(a);let i=m(2);return w(i.formLicencia.motivo,e)||(i.formLicencia.motivo=e),g(e)}),o()(),n(34,"div",161)(35,"label",162),r(36,"Observaciones"),o(),n(37,"textarea",206),T("ngModelChange",function(e){p(a);let i=m(2);return w(i.formLicencia.observaciones,e)||(i.formLicencia.observaciones=e),g(e)}),o()()()()}if(l&2){let a=m(2);s(3),x(a.registroSeleccionado.trabajadorNombre.charAt(0)),s(3),x(a.registroSeleccionado.trabajadorNombre),s(2),x(a.registroSeleccionado.trabajadorCargo),s(2),x(a.registroSeleccionado.trabajadorArea),s(5),E("ngModel",a.formLicencia.tipoLicencia),s(14),E("ngModel",a.formLicencia.dias),s(4),E("ngModel",a.formLicencia.motivo),s(4),E("ngModel",a.formLicencia.observaciones)}}function st(l,h){if(l&1){let a=j();n(0,"div",153),b("click",function(){p(a);let e=m();return g(e.mostrarModalLicencia=!1)}),n(1,"div",154),b("click",function(e){return p(a),g(e.stopPropagation())}),n(2,"div",155)(3,"h3",156),r(4,"\u{1F3E5} Registrar Licencia"),o(),n(5,"button",157),b("click",function(){p(a);let e=m();return g(e.mostrarModalLicencia=!1)}),r(6,"\u2716\uFE0F"),o()(),O(7,rt,38,8,"div",178),n(8,"div",175)(9,"button",176),b("click",function(){p(a);let e=m();return g(e.mostrarModalLicencia=!1)}),r(10,"Cancelar"),o(),n(11,"button",198),b("click",function(){p(a);let e=m();return g(e.guardarLicencia())}),r(12,"\u{1F3E5} Guardar Licencia"),o()()()()}if(l&2){let a=m();s(7),_("ngIf",a.registroSeleccionado)}}function ct(l,h){l&1&&(n(0,"span"),r(1,"\u2705"),o())}function lt(l,h){l&1&&(n(0,"span"),r(1,"\u274C"),o())}function dt(l,h){l&1&&(n(0,"span"),r(1,"\u26A0\uFE0F"),o())}function mt(l,h){l&1&&(n(0,"span"),r(1,"\u2139\uFE0F"),o())}function pt(l,h){l&1&&(n(0,"div",215),I(1,"div",216),o())}function gt(l,h){if(l&1){let a=j();n(0,"button",217),b("click",function(){p(a);let e=m(2);return g(e.cerrarNotificacion())}),r(1,"\u2716\uFE0F"),o()}}function ft(l,h){if(l&1&&(n(0,"div",207)(1,"div",208)(2,"div",209),O(3,ct,2,0,"span",33)(4,lt,2,0,"span",33)(5,dt,2,0,"span",33)(6,mt,2,0,"span",33)(7,pt,2,0,"div",210),o(),n(8,"div",211)(9,"div",212),r(10),o(),I(11,"div",213),o(),O(12,gt,2,0,"button",214),o()()),l&2){let a=m();_("@slideInOut",void 0),s(),_("ngClass","notificacion--"+a.notificacion.tipo),s(2),_("ngIf",a.notificacion.tipo==="success"),s(),_("ngIf",a.notificacion.tipo==="error"),s(),_("ngIf",a.notificacion.tipo==="warning"),s(),_("ngIf",a.notificacion.tipo==="info"),s(),_("ngIf",a.notificacion.tipo==="loading"),s(3),x(a.notificacion.titulo),s(),_("innerHTML",a.formatearMensajeNotificacion(a.notificacion.mensaje),G),s(),_("ngIf",a.notificacion.tipo!=="loading")}}function _t(l,h){l&1&&(n(0,"span"),r(1,"\u2705"),o())}function ut(l,h){l&1&&(n(0,"span"),r(1,"\u26A0\uFE0F"),o())}function ht(l,h){l&1&&(n(0,"span"),r(1,"\u26A0\uFE0F"),o())}function bt(l,h){l&1&&(n(0,"span"),r(1,"\u2139\uFE0F"),o())}function xt(l,h){if(l&1){let a=j();n(0,"div",218),b("click",function(){p(a);let e=m();return g(e.cancelarAccion())}),n(1,"div",219),b("click",function(e){return p(a),g(e.stopPropagation())}),n(2,"div",220)(3,"div",221),O(4,_t,2,0,"span",33)(5,ut,2,0,"span",33)(6,ht,2,0,"span",33)(7,bt,2,0,"span",33),o(),n(8,"h3",222),r(9),o()(),n(10,"div",223),I(11,"p",224),o(),n(12,"div",225)(13,"button",176),b("click",function(){p(a);let e=m();return g(e.cancelarAccion())}),r(14,"Cancelar"),o(),n(15,"button",226),b("click",function(){p(a);let e=m();return g(e.confirmarAccion())}),r(16," Confirmar "),o()()()()}if(l&2){let a=m();s(),_("@scaleInOut",void 0),s(),_("ngClass","modal-confirmacion__header--"+a.confirmacion.tipo),s(2),_("ngIf",a.confirmacion.tipo==="success"),s(),_("ngIf",a.confirmacion.tipo==="danger"),s(),_("ngIf",a.confirmacion.tipo==="warning"),s(),_("ngIf",a.confirmacion.tipo==="info"),s(2),x(a.confirmacion.titulo),s(2),_("innerHTML",a.confirmacion.mensaje,G),s(4),_("ngClass","btn--"+(a.confirmacion.tipo==="danger"?"danger":a.confirmacion.tipo==="warning"?"warning":"primary"))}}function Mt(l,h){if(l&1&&(n(0,"option",67),r(1),o()),l&2){let a=h.$implicit;_("value",a.RegimenID||a.regimenID||a.id),s(),z(" ",a.Nombre||a.nombre," ")}}function vt(l,h){if(l&1){let a=j();n(0,"div",161)(1,"label",162),r(2,"R\xE9gimen Laboral *"),o(),n(3,"select",163),T("ngModelChange",function(e){p(a);let i=m(2);return w(i.formHorariosMasivos.regimenLaboralId,e)||(i.formHorariosMasivos.regimenLaboralId=e),g(e)}),n(4,"option",42),r(5,"Seleccione un r\xE9gimen laboral"),o(),O(6,Mt,2,2,"option",43),o()()}if(l&2){let a=m(2);s(3),E("ngModel",a.formHorariosMasivos.regimenLaboralId),s(3),_("ngForOf",a.regimenesLaborales)}}function Ct(l,h){l&1&&(n(0,"p"),r(1," Se asignar\xE1 este horario a "),n(2,"strong"),r(3,"TODOS"),o(),r(4," los trabajadores activos del sistema. "),o())}function St(l,h){l&1&&(n(0,"p"),r(1," Se asignar\xE1 este horario a todos los trabajadores del r\xE9gimen laboral seleccionado. "),o())}function Pt(l,h){if(l&1){let a=j();n(0,"div",153),b("click",function(){p(a);let e=m();return g(e.mostrarModalHorariosMasivos=!1)}),n(1,"div",227),b("click",function(e){return p(a),g(e.stopPropagation())}),n(2,"div",155)(3,"h3",156),r(4,"\u23F0 Asignar Horarios Masivamente"),o(),n(5,"button",157),b("click",function(){p(a);let e=m();return g(e.mostrarModalHorariosMasivos=!1)}),r(6,"\u2716\uFE0F"),o()(),n(7,"div",158)(8,"div",161)(9,"label",162),r(10,"Tipo de Asignaci\xF3n *"),o(),n(11,"select",228),T("ngModelChange",function(e){p(a);let i=m();return w(i.formHorariosMasivos.tipoAsignacion,e)||(i.formHorariosMasivos.tipoAsignacion=e),g(e)}),b("change",function(){p(a);let e=m();return g(e.formHorariosMasivos.regimenLaboralId=null)}),n(12,"option",229),r(13,"\u{1F465} Todos los Trabajadores"),o(),n(14,"option",230),r(15,"\u{1F4CB} Por R\xE9gimen Laboral"),o()()(),O(16,vt,7,2,"div",231),I(17,"div",232),n(18,"h4",233),r(19,"\u{1F550} Horarios a Asignar"),o(),n(20,"div",160)(21,"div",164)(22,"label",162),r(23,"\u{1F305} Entrada Ma\xF1ana"),o(),n(24,"input",187),T("ngModelChange",function(e){p(a);let i=m();return w(i.formHorariosMasivos.horaEntradaManana,e)||(i.formHorariosMasivos.horaEntradaManana=e),g(e)}),o()(),n(25,"div",164)(26,"label",162),r(27,"\u{1F304} Salida Ma\xF1ana"),o(),n(28,"input",187),T("ngModelChange",function(e){p(a);let i=m();return w(i.formHorariosMasivos.horaSalidaManana,e)||(i.formHorariosMasivos.horaSalidaManana=e),g(e)}),o()(),n(29,"div",164)(30,"label",162),r(31,"\u{1F306} Entrada Tarde"),o(),n(32,"input",187),T("ngModelChange",function(e){p(a);let i=m();return w(i.formHorariosMasivos.horaEntradaTarde,e)||(i.formHorariosMasivos.horaEntradaTarde=e),g(e)}),o()(),n(33,"div",164)(34,"label",162),r(35,"\u{1F303} Salida Tarde"),o(),n(36,"input",187),T("ngModelChange",function(e){p(a);let i=m();return w(i.formHorariosMasivos.horaSalidaTarde,e)||(i.formHorariosMasivos.horaSalidaTarde=e),g(e)}),o()()(),n(37,"div",234)(38,"strong"),r(39,"\u2139\uFE0F Informaci\xF3n:"),o(),O(40,Ct,5,0,"p",33)(41,St,2,0,"p",33),o()(),n(42,"div",175)(43,"button",176),b("click",function(){p(a);let e=m();return g(e.mostrarModalHorariosMasivos=!1)}),r(44,"Cancelar"),o(),n(45,"button",235),b("click",function(){p(a);let e=m();return g(e.guardarHorariosMasivos())}),r(46," \u{1F4BE} Guardar Horarios "),o()()()()}if(l&2){let a=m();s(11),E("ngModel",a.formHorariosMasivos.tipoAsignacion),s(5),_("ngIf",a.formHorariosMasivos.tipoAsignacion==="regimen"),s(8),E("ngModel",a.formHorariosMasivos.horaEntradaManana),s(4),E("ngModel",a.formHorariosMasivos.horaSalidaManana),s(4),E("ngModel",a.formHorariosMasivos.horaEntradaTarde),s(4),E("ngModel",a.formHorariosMasivos.horaSalidaTarde),s(4),_("ngIf",a.formHorariosMasivos.tipoAsignacion==="todos"),s(),_("ngIf",a.formHorariosMasivos.tipoAsignacion==="regimen"&&a.formHorariosMasivos.regimenLaboralId),s(4),_("disabled",!a.formHorariosMasivos.horaEntradaManana||!a.formHorariosMasivos.horaSalidaManana||a.formHorariosMasivos.tipoAsignacion==="regimen"&&!a.formHorariosMasivos.regimenLaboralId)}}var Ft=(()=>{let h=class h{constructor(t,e,i,c){this.router=t,this.http=e,this.sanitizer=i,this.cdr=c,this.fechaSeleccionada="",this.horaActual="",this.horaCompleta="",this.minutos="",this.segundos="",this.ampm="",this.diaSemana="",this.diaMes="",this.mesNombre="",this.anio="",this.fechaCompleta="",this.registros=[],this.registrosFiltrados=[],this.resumenDiario=null,this.horario=xe,this.tiposJustificacion=Me,this.filtros={fecha:"",estado:"",regimenLaboral:"",busqueda:""},this.regimenesLaborales=[],this.cargando=!1,this.vistaActual="lista",this.mostrarModalRegistro=!1,this.mostrarModalJustificacion=!1,this.mostrarModalEdicion=!1,this.mostrarModalTardanza=!1,this.mostrarModalPermiso=!1,this.mostrarModalLicencia=!1,this.mostrarModalHorariosMasivos=!1,this.registroSeleccionado=null,this.formHorariosMasivos={tipoAsignacion:"todos",regimenLaboralId:null,horaEntradaManana:"08:00",horaSalidaManana:"13:00",horaEntradaTarde:"14:00",horaSalidaTarde:"17:00"},this.menuAbiertoId=null,this.notificacion={mostrar:!1,tipo:"info",titulo:"",mensaje:""},this.confirmacion={mostrar:!1,titulo:"",mensaje:"",tipo:"info"},this.procesandoAccion={tipo:null,registroId:null},this.formTardanza={horaEntradaManana:"",minutosRetraso:0,observaciones:""},this.formPermiso={tipoPermiso:"Medio d\xEDa",horas:"",motivo:"",observaciones:""},this.formLicencia={tipoLicencia:"Con goce de haber",dias:1,motivo:"",observaciones:""},this.areas=["Gerencia Municipal","Oficina de Recursos Humanos","Oficina de Administraci\xF3n","Gerencia de Desarrollo Social","Gerencia de Infraestructura","Serenazgo","Registro Civil"],this.estados=["Presente","Tardanza","Falta","Permiso","Licencia","Vacaciones","Comision"],this.apiAsistencias=`${q.apiUrl}/asistencias`,this.apiTrabajadores=`${q.apiUrl}/trabajadores`,this.apiRegimenesLaborales=`${q.apiUrl}/regimenes-laborales`,this.trabajadoresActivos=[],this.formularioRegistro={trabajadorId:"",fecha:"",horaEntradaManana:"",horaSalidaManana:"",horaEntradaTarde:"",horaSalidaTarde:"",tipoMarcacion:"Presente",justificacion:"",motivoJustificacion:"",observaciones:""},this.cargandoAsistencias=!1,this.timeoutCargarAsistencias=null,this._esDiaNoHabilCache=null}ngOnInit(){window.scrollTo(0,0),setTimeout(()=>{let t=document.querySelector(".main-content");t&&(t.scrollTop=0)},100),this.inicializarFecha(),this.inicializarReloj(),this.cargarRegimenesLaborales(),this.cargarAsistencias()}cargarRegimenesLaborales(){let t=localStorage.getItem("token"),e=t?{Authorization:`Bearer ${t}`}:{};this.http.get(`${this.apiRegimenesLaborales}`,{headers:e}).subscribe({next:i=>{console.log("\u{1F4CB} Reg\xEDmenes laborales cargados:",i.data),this.regimenesLaborales=i.data||[]},error:i=>{console.error("\u274C Error al cargar reg\xEDmenes laborales:",i),this.regimenesLaborales=[]}})}inicializarFecha(){let t=new Date;this.fechaSeleccionada=this.formatearFecha(t),this.filtros.fecha=this.fechaSeleccionada}inicializarReloj(){this.actualizarHora(),setInterval(()=>{this.actualizarHora()},1e3)}actualizarHora(){let t=new Date,e=t.getHours(),i=t.getMinutes(),c=t.getSeconds();this.ampm=e>=12?"p. m.":"a. m.",e=e%12,e=e||12,this.horaCompleta=String(e).padStart(2,"0"),this.minutos=String(i).padStart(2,"0"),this.segundos=String(c).padStart(2,"0"),this.horaActual=`${this.horaCompleta}:${this.minutos}:${this.segundos} ${this.ampm}`;let u=["Domingo","Lunes","Martes","Mi\xE9rcoles","Jueves","Viernes","S\xE1bado"],d=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];this.diaSemana=u[t.getDay()],this.diaMes=String(t.getDate()).padStart(2,"0"),this.mesNombre=d[t.getMonth()],this.anio=String(t.getFullYear()),this.fechaCompleta=`${this.diaSemana}, ${this.diaMes} de ${this.mesNombre} de ${this.anio}`,this.fechaSeleccionada||(this.fechaSeleccionada=this.formatearFecha(t))}formatearFecha(t){let e=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0"),c=String(t.getDate()).padStart(2,"0");return`${e}-${i}-${c}`}cargarAsistencias(){if(this.cargandoAsistencias){console.warn("\u26A0\uFE0F Ya hay una carga de asistencias en progreso, ignorando llamada duplicada");return}this.timeoutCargarAsistencias&&clearTimeout(this.timeoutCargarAsistencias),this._esDiaNoHabilCache=null,this.cargandoAsistencias=!0,this.cargando=!0,this.cdr.detectChanges(),console.log("\u{1F4CB} Cargando asistencias para:",this.fechaSeleccionada),console.log("\u{1F310} URL del backend:",`${this.apiAsistencias}/fecha/${this.fechaSeleccionada}`);let t=localStorage.getItem("token"),e=t?{Authorization:`Bearer ${t}`}:{};requestAnimationFrame(()=>{this.http.get(`${this.apiAsistencias}/fecha/${this.fechaSeleccionada}`,{headers:e,params:{estado:this.filtros.estado||"",regimenLaboral:this.filtros.regimenLaboral||"",busqueda:this.filtros.busqueda||""}}).subscribe({next:i=>{console.log("\u2705 Asistencias cargadas del backend:",i),console.log("\u{1F4CA} Datos recibidos:",i.data),this.registros=(i.data||[]).map(c=>{let u=this.fechaSeleccionada;c.fecha&&(typeof c.fecha=="string"?u=c.fecha.split("T")[0]:c.fecha instanceof Date&&(u=this.formatearFecha(c.fecha)));let d={id:c.id,trabajadorId:c.trabajadorId,trabajadorDni:c.trabajadorDni,trabajadorNombre:c.trabajadorNombre,trabajadorArea:c.trabajadorArea,trabajadorCargo:c.trabajadorCargo,trabajadorRegimenLaboral:c.regimenLaboralNombre||null,fecha:u,horaEntradaManana:c.horaEntradaManana||null,horaSalidaManana:c.horaSalidaManana||null,horaEntradaTarde:c.horaEntradaTarde||null,horaSalidaTarde:c.horaSalidaTarde||null,horarioAsignadoEntradaManana:c.horarioAsignadoEntradaManana||c.horaEntradaManana||null,horarioAsignadoSalidaManana:c.horarioAsignadoSalidaManana||c.horaSalidaManana||null,horarioAsignadoEntradaTarde:c.horarioAsignadoEntradaTarde||c.horaEntradaTarde||null,horarioAsignadoSalidaTarde:c.horarioAsignadoSalidaTarde||c.horaSalidaTarde||null,tipoMarcacion:c.tipoMarcacion||null,estado:this.mapearEstado(c.estado,c.tipoMarcacion,c.horaEntradaManana),minutosRetraso:c.minutosTardanza||0,horasTrabajadas:0,horasExtras:0,tieneJustificacion:!!c.justificacion,motivoJustificacion:c.motivoJustificacion||"",observaciones:c.observaciones||"",registradoPor:c.usuarioRegistro||"sistema",fechaRegistro:c.fechaRegistro?new Date(c.fechaRegistro):new Date};return console.log("\u{1F50D} Registro normalizado:",d),d}),console.log("\u{1F4CB} Total registros mapeados:",this.registros.length),this.http.get(`${this.apiTrabajadores}`,{headers:e}).subscribe({next:c=>{let u=c?.data||[];this.trabajadoresActivos=u.filter(d=>{let v=d.Activo===!0||d.Activo===1||d.Activo==="1"||d.Activo===void 0,k=(d.UsuarioCreacion||"").toString().toUpperCase(),M=(d.Codigo||"").toString().toUpperCase(),y=k.includes("DEMO")||M.startsWith("DEMO");return v&&!y}),console.log("\u{1F465} Trabajadores activos (para combinar asistencia):",this.trabajadoresActivos.length),this.trabajadoresActivos.length>0&&(console.log("\u{1F550} Verificando horarios asignados en trabajadores activos:"),this.trabajadoresActivos.slice(0,3).forEach((d,v)=>{console.log(`  Trabajador ${v+1} (${d.Nombres||d.nombres}):`,{entradaManana:d.HorarioHabitualEntradaManana||d.horarioHabitualEntradaManana,salidaManana:d.HorarioHabitualSalidaManana||d.horarioHabitualSalidaManana,entradaTarde:d.HorarioHabitualEntradaTarde||d.horarioHabitualEntradaTarde,salidaTarde:d.HorarioHabitualSalidaTarde||d.horarioHabitualSalidaTarde})})),setTimeout(()=>{let d=new Set(this.trabajadoresActivos.map(f=>f.TrabajadorID||f.trabajadorId||f.id));this.registros=(this.registros||[]).filter(f=>d.has(f.trabajadorId));let v=new Map;this.trabajadoresActivos.forEach(f=>{let C=f.TrabajadorID||f.trabajadorId||f.id;v.set(C,f)}),this.registros=this.registros.map(f=>{let C=v.get(f.trabajadorId);if(C){let R=C.HorarioHabitualEntradaManana||C.horarioHabitualEntradaManana||null,S=C.HorarioHabitualSalidaManana||C.horarioHabitualSalidaManana||null,D=C.HorarioHabitualEntradaTarde||C.horarioHabitualEntradaTarde||null,A=C.HorarioHabitualSalidaTarde||C.horarioHabitualSalidaTarde||null;f.horarioAsignadoEntradaManana=R,f.horarioAsignadoSalidaManana=S,f.horarioAsignadoEntradaTarde=D,f.horarioAsignadoSalidaTarde=A,this.registros.indexOf(f)<3&&console.log(`\u{1F550} Horarios actualizados para ${f.trabajadorNombre}:`,{entradaManana:R,salidaManana:S,entradaTarde:D,salidaTarde:A})}else console.warn(`\u26A0\uFE0F No se encontr\xF3 trabajador activo para registro ID: ${f.trabajadorId}`);return f});let k=new Set(this.registros.map(f=>f.trabajadorId)),M=[...this.registros],y=10,P=f=>{let C=Math.min(f+y,this.trabajadoresActivos.length);for(let R=f;R<C;R++){let S=this.trabajadoresActivos[R],D=S.TrabajadorID||S.trabajadorId||S.id;if(!k.has(D)){let A=`${(S.ApellidoPaterno||S.apellidoPaterno||"").trim()} ${(S.ApellidoMaterno||S.apellidoMaterno||"").trim()}, ${(S.Nombres||S.nombres||"").trim()}`.replace(/\s+/g," ").trim(),F=S.HorarioHabitualEntradaManana||S.horarioHabitualEntradaManana||null,$=S.HorarioHabitualSalidaManana||S.horarioHabitualSalidaManana||null,Y=S.HorarioHabitualEntradaTarde||S.horarioHabitualEntradaTarde||null,J=S.HorarioHabitualSalidaTarde||S.horarioHabitualSalidaTarde||null;M.push({id:0,fecha:this.fechaSeleccionada,trabajadorId:D,trabajadorDni:S.NumeroDocumento||S.dni||"",trabajadorNombre:A,trabajadorArea:S.AreaNombre||S.areaNombre||S.area||"",trabajadorCargo:(S.CargoNombre||S.cargoNombre||S.cargo||"").toUpperCase(),trabajadorRegimenLaboral:S.RegimenLaboralNombre||S.regimenLaboralNombre||null,horaEntradaManana:null,horaSalidaManana:null,horaEntradaTarde:null,horaSalidaTarde:null,horarioAsignadoEntradaManana:F,horarioAsignadoSalidaManana:$,horarioAsignadoEntradaTarde:Y,horarioAsignadoSalidaTarde:J,estado:"Falta",tipoMarcacion:"Sistema",minutosRetraso:0,horasTrabajadas:0,horasExtras:0,tieneJustificacion:!1,motivoJustificacion:"",documentoJustificacion:"",observaciones:"",registradoPor:"sistema",fechaRegistro:new Date})}}C<this.trabajadoresActivos.length?setTimeout(()=>P(C),50):(this.registros=M,this.registrosFiltrados=[...this.registros],this.cargando=!1,this.cargandoAsistencias=!1,console.log("\u{1F4CB} Registros finales antes de calcular resumen:",this.registros.length),this.actualizarResumenDesdeRegistros(),this.cdr.detectChanges())};P(0)},0)},error:c=>{console.warn("\u26A0\uFE0F No se pudo cargar trabajadores activos, usando solo registros del d\xEDa:",c),this.registrosFiltrados=[...this.registros],this.cargando=!1,this.cargandoAsistencias=!1,this.cargarResumenDiario()}})},error:i=>{console.error("\u274C Error al cargar asistencias:",i),console.error("\u{1F50D} Detalles del error:",i),this.cargandoAsistencias=!1,this.http.get(`${this.apiTrabajadores}`,{headers:e}).subscribe({next:c=>{let u=c?.data||[];this.trabajadoresActivos=u.filter(d=>{let v=d.Activo===!0||d.Activo===1||d.Activo==="1"||d.Activo===void 0,k=(d.UsuarioCreacion||"").toString().toUpperCase(),M=(d.Codigo||"").toString().toUpperCase(),y=k.includes("DEMO")||M.startsWith("DEMO");return v&&!y}),this.registros=(this.trabajadoresActivos||[]).map(d=>({id:0,fecha:this.fechaSeleccionada,trabajadorId:d.TrabajadorID||d.trabajadorId||d.id,trabajadorDni:d.NumeroDocumento||d.dni||"",trabajadorNombre:`${(d.ApellidoPaterno||"").trim()} ${(d.ApellidoMaterno||"").trim()}, ${(d.Nombres||"").trim()}`.replace(/\s+/g," ").trim(),trabajadorArea:d.AreaNombre||d.areaNombre||d.area||"",trabajadorCargo:(d.CargoNombre||d.cargoNombre||d.cargo||"").toUpperCase(),horaEntradaManana:"---",horaSalidaManana:"---",horaEntradaTarde:"---",horaSalidaTarde:"---",estado:"Falta",tipoMarcacion:"Sistema",minutosRetraso:0,horasTrabajadas:0,horasExtras:0,tieneJustificacion:!1,motivoJustificacion:"",documentoJustificacion:"",observaciones:"",registradoPor:"sistema",fechaRegistro:new Date})),this.registrosFiltrados=[...this.registros],this.cargando=!1,this.cargandoAsistencias=!1,this.cargarResumenDiario()},error:()=>{this.cargando=!1,this.cargandoAsistencias=!1,console.log("\u26A0\uFE0F Cargando datos de ejemplo debido al error"),this.cargarDatosEjemplo()}})}})})}cargarResumenDiario(){console.log("\u{1F4CA} Cargando resumen diario para:",this.fechaSeleccionada),console.log("\u{1F310} URL del resumen:",`${this.apiAsistencias}/resumen/${this.fechaSeleccionada}`);let t=localStorage.getItem("token"),e=t?{Authorization:`Bearer ${t}`}:{};this.http.get(`${this.apiAsistencias}/resumen/${this.fechaSeleccionada}`,{headers:e}).subscribe({next:i=>{console.log("\u{1F4CA} Resumen diario cargado exitosamente del backend:",i),this.actualizarResumenDesdeRegistros()},error:i=>{console.error("\u274C Error al cargar resumen:",i),console.log("\u26A0\uFE0F Calculando resumen desde registros locales"),this.actualizarResumenDesdeRegistros()}})}actualizarRegistroLocal(t,e){let i=this.registros.findIndex(c=>c.trabajadorId===t);if(i!==-1){this.registros[i]=V(V({},this.registros[i]),e);let c=this.registrosFiltrados.findIndex(u=>u.trabajadorId===t);c!==-1&&(this.registrosFiltrados[c]=V(V({},this.registrosFiltrados[c]),e))}}actualizarResumenDesdeRegistros(){let t=this.registros.filter(f=>{let C=f.fecha;return typeof C=="string"&&C.includes("T")&&(C=C.split("T")[0]),C===this.fechaSeleccionada});console.log("\u{1F50D} Fecha seleccionada:",this.fechaSeleccionada),console.log("\u{1F50D} Registros totales:",this.registros.length),console.log("\u{1F50D} Registros del d\xEDa filtrados:",t.length),t.length>0&&(console.log("\u{1F50D} Primer registro del d\xEDa:",t[0]),console.log("\u{1F50D} Primer registro - estado:",t[0].estado),console.log("\u{1F50D} Primer registro - tipoMarcacion:",t[0].tipoMarcacion),console.log("\u{1F50D} Primer registro - horas:",{entradaManana:t[0].horaEntradaManana,entradaTarde:t[0].horaEntradaTarde}));let e=this.trabajadoresActivos?.length||t.length,i=t.filter(f=>{let C=f.tipoMarcacion,R=f.horaEntradaManana&&f.horaEntradaManana!=="---"||f.horaEntradaTarde&&f.horaEntradaTarde!=="---";return!!(C==="Presente"||f.estado==="Validado"&&R||f.estado==="Presente")}).length,c=t.filter(f=>f.tipoMarcacion==="Tardanza"||f.estado==="Tardanza").length,u=t.filter(f=>{let C=f.horaEntradaManana&&f.horaEntradaManana!=="---"||f.horaEntradaTarde&&f.horaEntradaTarde!=="---";return f.tipoMarcacion==="Falta"||f.estado==="Falta"||!C}).length,d=t.filter(f=>f.tipoMarcacion==="Permiso"||f.estado==="Permiso").length,v=t.filter(f=>f.tipoMarcacion==="Licencia"||f.estado==="Licencia").length,k=t.filter(f=>f.tipoMarcacion==="Vacaciones"||f.estado==="Vacaciones").length,M=t.filter(f=>f.tipoMarcacion==="Comision"||f.estado==="Comision").length,y=i+c+M,P=e>0?Math.round(y/e*100*100)/100:0;this.resumenDiario={fecha:this.fechaSeleccionada,totalTrabajadores:e,presentes:i,tardanzas:c,faltas:u,permisos:d,licencias:v,vacaciones:k,comisiones:M,porcentajeAsistencia:P},console.log(`\u{1F4CA} Resumen calculado para ${this.fechaSeleccionada}:`,this.resumenDiario),console.log("\u{1F50D} Debug - Primer registro:",t[0]),console.log("\u{1F50D} Debug - Registros con tipoMarcacion Presente:",t.filter(f=>f.tipoMarcacion==="Presente").length),console.log("\u{1F50D} Debug - Registros con estado Validado y horas:",t.filter(f=>{let C=f.horaEntradaManana&&f.horaEntradaManana!=="---"||f.horaEntradaTarde&&f.horaEntradaTarde!=="---";return f.estado==="Validado"&&C}).length)}cargarTrabajadoresActivos(){let t=localStorage.getItem("token"),e=t?{Authorization:`Bearer ${t}`}:{};this.http.get(`${this.apiAsistencias}/trabajadores`,{headers:e}).subscribe({next:i=>{console.log("\u{1F465} Trabajadores activos cargados:",i.data),this.trabajadoresActivos=i.data},error:i=>{console.error("\u274C Error al cargar trabajadores:",i),this.trabajadoresActivos=[]}})}cargarDatosEjemplo(){this.registros=[{id:1,fecha:this.fechaSeleccionada,trabajadorId:1,trabajadorDni:"43256789",trabajadorNombre:"Garc\xEDa Rodr\xEDguez, Carlos Alberto",trabajadorArea:"Gerencia Municipal",trabajadorCargo:"Gerente Municipal",horaEntrada:"07:55",horaSalida:"13:05",horaEntradaTarde:"14:00",horaSalidaTarde:"17:30",estado:"Presente",tipoMarcacion:"Biometrico",minutosRetraso:0,horasTrabajadas:8.5,horasExtras:0,tieneJustificacion:!1,motivoJustificacion:"",documentoJustificacion:"",observaciones:"",ubicacionEntrada:"",ubicacionSalida:"",registradoPor:"admin",fechaRegistro:new Date,modificadoPor:"",fechaModificacion:void 0}],this.registrosFiltrados=[...this.registros],this.cargando=!1,this.calcularResumen()}aplicarFiltros(){if(this.filtros.regimenLaboral){this.cargarAsistencias();return}let t=[...this.registros];if(this.filtros.busqueda){let e=this.filtros.busqueda.toLowerCase();t=t.filter(i=>i.trabajadorNombre.toLowerCase().includes(e)||i.trabajadorDni.includes(e)||i.trabajadorArea.toLowerCase().includes(e)||i.trabajadorRegimenLaboral&&i.trabajadorRegimenLaboral.toLowerCase().includes(e))}this.filtros.estado&&(t=t.filter(e=>e.estado===this.filtros.estado||e.tipoMarcacion===this.filtros.estado)),this.registrosFiltrados=t}calcularResumen(){let t=this.registros.length,e=this.registros.filter(P=>P.estado==="Presente").length,i=this.registros.filter(P=>P.estado==="Tardanza").length,c=this.registros.filter(P=>P.estado==="Falta").length,u=this.registros.filter(P=>P.estado==="Permiso").length,d=this.registros.filter(P=>P.estado==="Licencia").length,v=this.registros.filter(P=>P.estado==="Vacaciones").length,k=this.registros.filter(P=>P.estado==="Comision").length,M=e+i+k,y=t>0?M/t*100:0;this.resumenDiario={fecha:this.fechaSeleccionada,totalTrabajadores:t,presentes:e,tardanzas:i,faltas:c,permisos:u,licencias:d,vacaciones:v,comisiones:k,porcentajeAsistencia:Math.round(y*100)/100}}cambiarFecha(t){console.log(`\u{1F4C5} Cambiando fecha: ${this.fechaSeleccionada} ${t>0?"+":""}${t} d\xEDas`);let e=this.fechaSeleccionada.split("-");if(e.length!==3){console.error("\u274C Formato de fecha inv\xE1lido:",this.fechaSeleccionada);return}let i=parseInt(e[0],10),c=parseInt(e[1],10)-1,u=parseInt(e[2],10),d=new Date(i,c,u);console.log("\u{1F4C5} Fecha parseada:",d),d.setDate(d.getDate()+t),console.log("\u{1F4C5} Nueva fecha calculada:",d),this.fechaSeleccionada=this.formatearFecha(d),this.filtros.fecha=this.fechaSeleccionada,this._esDiaNoHabilCache=null,console.log("\u{1F4C5} Fecha actualizada a:",this.fechaSeleccionada),this.cargarAsistencias()}irHoy(){this.inicializarFecha(),this.cargarAsistencias()}registrarAsistenciaManual(){if(console.log("\u{1F4DD} Registrando asistencia manual:",this.formularioRegistro),!this.formularioRegistro.trabajadorId||!this.formularioRegistro.fecha){this.mostrarNotificacion("warning","\u26A0\uFE0F Advertencia","Debe seleccionar un trabajador y una fecha",3e3);return}let t=U(V({},this.formularioRegistro),{horaEntradaManana:this.formularioRegistro.horaEntradaManana&&this.formularioRegistro.horaEntradaManana.trim()?this.formularioRegistro.horaEntradaManana:null,horaSalidaManana:this.formularioRegistro.horaSalidaManana&&this.formularioRegistro.horaSalidaManana.trim()?this.formularioRegistro.horaSalidaManana:null,horaEntradaTarde:this.formularioRegistro.horaEntradaTarde&&this.formularioRegistro.horaEntradaTarde.trim()?this.formularioRegistro.horaEntradaTarde:null,horaSalidaTarde:this.formularioRegistro.horaSalidaTarde&&this.formularioRegistro.horaSalidaTarde.trim()?this.formularioRegistro.horaSalidaTarde:null,justificacion:this.formularioRegistro.justificacion&&this.formularioRegistro.justificacion.trim()?this.formularioRegistro.justificacion:null,motivoJustificacion:this.formularioRegistro.motivoJustificacion&&this.formularioRegistro.motivoJustificacion.trim()?this.formularioRegistro.motivoJustificacion:null,observaciones:this.formularioRegistro.observaciones&&this.formularioRegistro.observaciones.trim()?this.formularioRegistro.observaciones:null});console.log("\u{1F4E4} Datos a enviar:",t);let e=localStorage.getItem("token"),i=e?{Authorization:`Bearer ${e}`}:{};this.http.post(`${this.apiAsistencias}/registrar`,t,{headers:i}).subscribe({next:c=>{console.log("\u2705 Asistencia registrada:",c),this.mostrarNotificacion("success","\u2705 \xC9xito","Asistencia registrada exitosamente",3e3),this.mostrarModalRegistro=!1,this.restaurarTopbarSidebar(),this.limpiarFormulario(),setTimeout(()=>{requestAnimationFrame(()=>{this.cargarAsistencias()})},1e3)},error:c=>{console.error("\u274C Error al registrar asistencia:",c),this.mostrarNotificacion("error","\u274C Error","Error al registrar la asistencia: "+(c.error?.message||c.message),4e3)}})}limpiarFormulario(){this.formularioRegistro={trabajadorId:"",fecha:this.fechaSeleccionada,horaEntradaManana:"",horaSalidaManana:"",horaEntradaTarde:"",horaSalidaTarde:"",tipoMarcacion:"Presente",justificacion:"",motivoJustificacion:"",observaciones:""}}abrirModalRegistro(){this.formularioRegistro.fecha=this.fechaSeleccionada,this.cargarTrabajadoresActivos(),this.mostrarModalRegistro=!0,setTimeout(()=>{document.documentElement.classList.add("modal-open"),document.body.classList.add("modal-open");let t=document.querySelector("app-topbar");if(t){t.style.setProperty("z-index","1","important");let i=t.querySelector(".topbar");i&&(i.style.setProperty("z-index","1","important"),i.style.setProperty("pointer-events","none","important"))}let e=document.querySelector("app-sidebar");e&&(e.style.setProperty("z-index","1","important"),e.style.setProperty("pointer-events","none","important"))},100)}restaurarTopbarSidebar(){setTimeout(()=>{document.documentElement.classList.remove("modal-open"),document.body.classList.remove("modal-open");let t=document.querySelector("app-topbar");if(t){t.style.setProperty("z-index","100000","important"),t.style.setProperty("pointer-events","auto","important"),t.style.setProperty("visibility","visible","important");let i=t.querySelector(".topbar");i&&(i.style.setProperty("z-index","100000","important"),i.style.setProperty("pointer-events","auto","important"),i.style.setProperty("visibility","visible","important"))}let e=document.querySelector("app-sidebar");e&&(e.style.setProperty("z-index","1000","important"),e.style.setProperty("pointer-events","auto","important"),e.style.setProperty("visibility","visible","important")),document.body.offsetHeight},150)}marcarEntrada(t){let e=new Date,i=`${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`;console.log(`Marcar entrada: Trabajador ${t} a las ${i}`)}marcarSalida(t){let e=new Date,i=`${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`;console.log(`Marcar salida: Trabajador ${t} a las ${i}`)}abrirModalJustificacion(t){this.registroSeleccionado=t,this.mostrarModalJustificacion=!0}guardarJustificacion(){console.log("Guardar justificaci\xF3n:",this.registroSeleccionado),this.mostrarModalJustificacion=!1}abrirModalTardanza(t){this.registroSeleccionado=t;let e=new Date,i=`${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`;this.formTardanza={horaEntradaManana:t.horaEntradaManana&&t.horaEntradaManana!=="---"?t.horaEntradaManana:i,minutosRetraso:t.minutosTardanza||t.minutosRetraso||0,observaciones:t.observaciones||""},this.mostrarModalTardanza=!0}guardarTardanza(){if(!this.registroSeleccionado||!this.formTardanza.horaEntradaManana){this.mostrarNotificacion("warning","\u26A0\uFE0F Advertencia","Por favor complete la hora de entrada",3e3);return}let t={trabajadorId:this.registroSeleccionado.trabajadorId,fecha:this.fechaSeleccionada,horaEntradaManana:this.formTardanza.horaEntradaManana,horaSalidaManana:this.registroSeleccionado.horaSalidaManana&&this.registroSeleccionado.horaSalidaManana!=="---"?this.registroSeleccionado.horaSalidaManana:null,horaEntradaTarde:this.registroSeleccionado.horaEntradaTarde&&this.registroSeleccionado.horaEntradaTarde!=="---"?this.registroSeleccionado.horaEntradaTarde:null,horaSalidaTarde:this.registroSeleccionado.horaSalidaTarde&&this.registroSeleccionado.horaSalidaTarde!=="---"?this.registroSeleccionado.horaSalidaTarde:null,tipoMarcacion:"Tardanza",minutosTardanza:parseInt(this.formTardanza.minutosRetraso)||0,observaciones:this.formTardanza.observaciones||"Marcado como tardanza"};console.log("\u{1F4E4} [Frontend] Enviando datos de tardanza:",{trabajadorId:t.trabajadorId,fecha:t.fecha,horaEntradaManana:t.horaEntradaManana,minutosTardanza:t.minutosTardanza,minutosTardanza_TIPO:typeof t.minutosTardanza,formTardanza_minutosRetraso:this.formTardanza.minutosRetraso,tipoMarcacion:t.tipoMarcacion});let e=localStorage.getItem("token"),i=e?{Authorization:`Bearer ${e}`}:{};this.iniciarProcesamiento("marcar-tardanza",this.obtenerIdRegistro(this.registroSeleccionado)),this.mostrarNotificacion("loading","Procesando...",`Registrando tardanza para ${this.registroSeleccionado?.trabajadorNombre}`,0),this.http.post(`${this.apiAsistencias}/marcar-tardanza`,t,{headers:i}).subscribe({next:c=>{this.actualizarRegistroLocal(this.registroSeleccionado.trabajadorId,{estado:"Tardanza",tipoMarcacion:"Tardanza",horaEntradaManana:t.horaEntradaManana,horaSalidaManana:t.horaSalidaManana,horaEntradaTarde:t.horaEntradaTarde,horaSalidaTarde:t.horaSalidaTarde,minutosRetraso:t.minutosTardanza||0}),this.finalizarProcesamiento(),this.cerrarNotificacion(),this.mostrarNotificacion("success","\u2705 \xC9xito",`${this.registroSeleccionado?.trabajadorNombre} marcado con TARDANZA`,3e3),this.mostrarModalTardanza=!1,this.actualizarResumenDesdeRegistros(),this.cdr.detectChanges()},error:c=>{console.error("\u274C Error al marcar tardanza:",c),this.finalizarProcesamiento(),this.cerrarNotificacion(),this.mostrarNotificacion("error","\u274C Error","Error al marcar tardanza: "+(c.error?.message||c.message),4e3)}})}abrirModalPermiso(t){this.registroSeleccionado=t,this.formPermiso={tipoPermiso:"Medio d\xEDa",horas:"",motivo:"",observaciones:""},this.mostrarModalPermiso=!0}guardarPermiso(){if(!this.registroSeleccionado||!this.formPermiso.motivo){this.mostrarNotificacion("warning","\u26A0\uFE0F Advertencia","Por favor complete el motivo del permiso",3e3);return}let t={trabajadorId:this.registroSeleccionado.trabajadorId,fecha:this.fechaSeleccionada,tipoPermiso:this.formPermiso.tipoPermiso,horas:this.formPermiso.horas||null,motivo:this.formPermiso.motivo,horaEntradaManana:this.formPermiso.tipoPermiso==="Todo el d\xEDa"?null:this.registroSeleccionado.horaEntradaManana&&this.registroSeleccionado.horaEntradaManana!=="---"?this.registroSeleccionado.horaEntradaManana:null,horaSalidaManana:this.formPermiso.tipoPermiso==="Todo el d\xEDa"?null:this.registroSeleccionado.horaSalidaManana&&this.registroSeleccionado.horaSalidaManana!=="---"?this.registroSeleccionado.horaSalidaManana:null,horaEntradaTarde:this.formPermiso.tipoPermiso==="Todo el d\xEDa"?null:this.registroSeleccionado.horaEntradaTarde&&this.registroSeleccionado.horaEntradaTarde!=="---"?this.registroSeleccionado.horaEntradaTarde:null,horaSalidaTarde:this.formPermiso.tipoPermiso==="Todo el d\xEDa"?null:this.registroSeleccionado.horaSalidaTarde&&this.registroSeleccionado.horaSalidaTarde!=="---"?this.registroSeleccionado.horaSalidaTarde:null,tipoMarcacion:"Permiso",observaciones:this.formPermiso.observaciones||`Permiso: ${this.formPermiso.motivo}`},e=localStorage.getItem("token"),i=e?{Authorization:`Bearer ${e}`}:{};this.iniciarProcesamiento("marcar-permiso",this.obtenerIdRegistro(this.registroSeleccionado)),this.mostrarNotificacion("loading","Procesando...",`Registrando permiso para ${this.registroSeleccionado?.trabajadorNombre}`,0),this.http.post(`${this.apiAsistencias}/marcar-permiso`,t,{headers:i}).subscribe({next:c=>{this.actualizarRegistroLocal(this.registroSeleccionado.trabajadorId,{estado:"Permiso",tipoMarcacion:"Permiso",horaEntradaManana:t.horaEntradaManana,horaSalidaManana:t.horaSalidaManana,horaEntradaTarde:t.horaEntradaTarde,horaSalidaTarde:t.horaSalidaTarde}),this.finalizarProcesamiento(),this.cerrarNotificacion(),this.mostrarNotificacion("success","\u2705 \xC9xito",`${this.registroSeleccionado?.trabajadorNombre} marcado con PERMISO`,3e3),this.mostrarModalPermiso=!1,this.actualizarResumenDesdeRegistros(),this.cdr.detectChanges()},error:c=>{console.error("\u274C Error al marcar permiso:",c),this.finalizarProcesamiento(),this.cerrarNotificacion(),this.mostrarNotificacion("error","\u274C Error","Error al marcar permiso: "+(c.error?.message||c.message),4e3)}})}abrirModalLicencia(t){this.registroSeleccionado=t,this.formLicencia={tipoLicencia:"Con goce de haber",dias:1,motivo:"",observaciones:""},this.mostrarModalLicencia=!0}guardarLicencia(){if(!this.registroSeleccionado||!this.formLicencia.motivo){this.mostrarNotificacion("warning","\u26A0\uFE0F Advertencia","Por favor complete el motivo de la licencia",3e3);return}let t={trabajadorId:this.registroSeleccionado.trabajadorId,fecha:this.fechaSeleccionada,tipoLicencia:this.formLicencia.tipoLicencia,dias:this.formLicencia.dias,motivo:this.formLicencia.motivo,horaEntradaManana:null,horaSalidaManana:null,horaEntradaTarde:null,horaSalidaTarde:null,tipoMarcacion:"Licencia",observaciones:this.formLicencia.observaciones||`Licencia ${this.formLicencia.tipoLicencia}: ${this.formLicencia.motivo}`},e=localStorage.getItem("token"),i=e?{Authorization:`Bearer ${e}`}:{};this.iniciarProcesamiento("marcar-licencia",this.obtenerIdRegistro(this.registroSeleccionado)),this.mostrarNotificacion("loading","Procesando...",`Registrando licencia para ${this.registroSeleccionado?.trabajadorNombre}`,0),this.http.post(`${this.apiAsistencias}/marcar-licencia`,t,{headers:i}).subscribe({next:c=>{this.actualizarRegistroLocal(this.registroSeleccionado.trabajadorId,{estado:"Licencia",tipoMarcacion:"Licencia",horaEntradaManana:null,horaSalidaManana:null,horaEntradaTarde:null,horaSalidaTarde:null}),this.finalizarProcesamiento(),this.cerrarNotificacion(),this.mostrarNotificacion("success","\u2705 \xC9xito",`${this.registroSeleccionado?.trabajadorNombre} marcado con LICENCIA`,3e3),this.mostrarModalLicencia=!1,this.actualizarResumenDesdeRegistros(),this.cdr.detectChanges()},error:c=>{console.error("\u274C Error al marcar licencia:",c),this.finalizarProcesamiento(),this.cerrarNotificacion(),this.mostrarNotificacion("error","\u274C Error","Error al marcar licencia: "+(c.error?.message||c.message),4e3)}})}exportarExcel(){console.log("Exportar a Excel:",this.registrosFiltrados.length,"registros")}exportarPDF(){console.log("Exportar a PDF:",this.registrosFiltrados.length,"registros")}limpiarFiltros(){this.filtros={fecha:this.fechaSeleccionada,estado:"",regimenLaboral:"",busqueda:""},this.aplicarFiltros()}mapearEstado(t,e,i){return e||(!i||i==="---"||i==="--:--"?"Falta":t==="Validado"&&i?"Presente":t==="Falta"?"Falta":t||"Falta")}getEstadoBadgeClass(t){return{Presente:"badge--presente",Tardanza:"badge--tardanza",Falta:"badge--falta",Permiso:"badge--permiso",Licencia:"badge--licencia",Vacaciones:"badge--vacaciones",Comision:"badge--comision",Validado:""}[t]||""}formatearHora(t){return t||"--:--"}calcularTiempoTrabajado(t,e){if(!t||!e)return"--";let[i,c]=t.split(":").map(Number),[u,d]=e.split(":").map(Number),v=i*60+c,M=u*60+d-v,y=Math.floor(M/60),P=M%60;return`${y}h ${P}m`}marcarPresente(t){console.log("\u{1F535} marcarPresente llamado para:",t.trabajadorNombre),t.horarioAsignadoEntradaManana&&t.horarioAsignadoSalidaManana||this.mostrarNotificacion("info","\u2139\uFE0F Informaci\xF3n",`El trabajador ${t.trabajadorNombre} no tiene horarios asignados. Puede marcar como presente, pero se recomienda asignar horarios para calcular tardanzas autom\xE1ticamente.`,3e3),this.mostrarConfirmacion("Marcar como Presente",`\xBFDeseas marcar a <strong>${t.trabajadorNombre}</strong> como PRESENTE?`,"success",()=>{console.log("\u2705 Confirmaci\xF3n aceptada para marcar presente");let i=t.horarioAsignadoEntradaManana||null,c=t.horarioAsignadoSalidaManana||null,u=t.horarioAsignadoEntradaTarde||null,d=t.horarioAsignadoSalidaTarde||null,v={trabajadorId:t.trabajadorId,fecha:this.fechaSeleccionada,horaEntradaManana:i&&i!=="---"&&i!=="--:--"?i:null,horaSalidaManana:c&&c!=="---"&&c!=="--:--"?c:null,horaEntradaTarde:u&&u!=="---"&&u!=="--:--"?u:null,horaSalidaTarde:d&&d!=="---"&&d!=="--:--"?d:null,tipoMarcacion:"Presente",estado:"Presente",observaciones:"Marcado manualmente como presente"};console.log("\u2705 Marcando presente:",v),this.iniciarProcesamiento("marcar-presente",this.obtenerIdRegistro(t)),this.mostrarNotificacion("loading","Procesando...",`Marcando a ${t.trabajadorNombre} como presente`,0);let k=localStorage.getItem("token"),M=k?{Authorization:`Bearer ${k}`}:{};this.http.post(`${this.apiAsistencias}/marcar-presente`,v,{headers:M}).subscribe({next:y=>{console.log("\u2705 Marcado como presente:",y),this.actualizarRegistroLocal(t.trabajadorId,{estado:"Presente",tipoMarcacion:"Presente",horaEntradaManana:v.horaEntradaManana,horaSalidaManana:v.horaSalidaManana,horaEntradaTarde:v.horaEntradaTarde,horaSalidaTarde:v.horaSalidaTarde}),window.parent&&window.parent.postMessage({type:"asistencia-actualizada"},"*"),window.dispatchEvent(new CustomEvent("asistencia-actualizada")),this.finalizarProcesamiento(),this.cerrarNotificacion(),this.mostrarNotificacion("success","\u2705 \xC9xito",`${t.trabajadorNombre} marcado como PRESENTE`,3e3),this.actualizarResumenDesdeRegistros(),this.cdr.detectChanges()},error:y=>{console.error("\u274C Error al marcar presente:",y),this.finalizarProcesamiento(),this.cerrarNotificacion(),this.mostrarNotificacion("error","\u274C Error","Error al marcar presente: "+(y.error?.message||y.message),4e3)}})})}todosEstanPresentes(){return this.registrosFiltrados.length===0?!1:this.registrosFiltrados.every(e=>{let i=e.estado||e.tipoMarcacion||"";return i==="Presente"||i==="Tardanza"})}marcarTodosPresentes(){let t=this.registrosFiltrados.filter(d=>{let v=d.estado||d.tipoMarcacion||"";return v!=="Presente"&&v!=="Tardanza"});if(t.length===0){this.mostrarNotificacion("info","\u2139\uFE0F Informaci\xF3n","Todos los trabajadores ya est\xE1n marcados como presentes",3e3);return}let e=t.filter(d=>d.horarioAsignadoEntradaManana&&d.horarioAsignadoSalidaManana);if(e.length===0){this.mostrarNotificacion("warning","\u26A0\uFE0F Advertencia",'Ning\xFAn trabajador tiene horarios asignados. Por favor, asigne horarios primero usando la opci\xF3n "Asignar Horarios".',4e3);return}let i=e.length,c=t.length-e.length,u=`\xBFDeseas marcar a <strong>${i} trabajador(es)</strong> como PRESENTE?`;c>0&&(u+=`<br><small style="color: #fbbf24;">\u26A0\uFE0F ${c} trabajador(es) sin horarios asignados ser\xE1n omitidos.</small>`),this.mostrarConfirmacion("Marcar Todos como Presentes",u,"success",()=>{console.log(`\u2705 Marcando ${i} trabajadores como presentes...`),this.iniciarProcesamiento("marcar-todos-presentes","masivo"),this.mostrarNotificacion("loading","Procesando...",`Marcando ${i} trabajador(es) como presentes...`,0);let d=localStorage.getItem("token"),v=d?{Authorization:`Bearer ${d}`}:{},k=e.map((M,y)=>{let P=M.horarioAsignadoEntradaManana||null,f=M.horarioAsignadoSalidaManana||null,C=M.horarioAsignadoEntradaTarde||null,R=M.horarioAsignadoSalidaTarde||null,S={trabajadorId:M.trabajadorId,fecha:this.fechaSeleccionada,horaEntradaManana:P&&P!=="---"&&P!=="--:--"?P:null,horaSalidaManana:f&&f!=="---"&&f!=="--:--"?f:null,horaEntradaTarde:C&&C!=="---"&&C!=="--:--"?C:null,horaSalidaTarde:R&&R!=="---"&&R!=="--:--"?R:null,tipoMarcacion:"Presente",estado:"Presente",observaciones:"Marcado masivamente como presente"};return this.http.post(`${this.apiAsistencias}/marcar-presente`,S,{headers:v}).toPromise()});Promise.all(k).then(M=>{console.log(`\u2705 ${M.length} trabajadores marcados como presentes`),this.finalizarProcesamiento(),this.cerrarNotificacion(),this.mostrarNotificacion("success","\u2705 \xC9xito",`${i} trabajador(es) marcado(s) como PRESENTE`,4e3),setTimeout(()=>{requestAnimationFrame(()=>{this.cargarAsistencias()})},1e3)}).catch(M=>{console.error("\u274C Error al marcar todos como presentes:",M),this.finalizarProcesamiento(),this.cerrarNotificacion(),this.mostrarNotificacion("error","\u274C Error","Error al marcar trabajadores: "+(M.error?.message||M.message),4e3)})})}marcarTodosFalta(){let t=this.registrosFiltrados.filter(i=>{let c=i.estado||i.tipoMarcacion||"";return c==="Presente"||c==="Tardanza"});if(t.length===0){this.mostrarNotificacion("info","\u2139\uFE0F Informaci\xF3n","No hay trabajadores marcados como presentes para cambiar a falta",3e3);return}let e=t.length;this.mostrarConfirmacion("Marcar Todos como Falta",`\xBFDeseas marcar a <strong>${e} trabajador(es)</strong> como FALTA?`,"danger",()=>{console.log(`\u274C Marcando ${e} trabajadores como falta...`),this.iniciarProcesamiento("marcar-todos-falta","masivo"),this.mostrarNotificacion("loading","Procesando...",`Marcando ${e} trabajador(es) como falta...`,0);let i=localStorage.getItem("token"),c=i?{Authorization:`Bearer ${i}`}:{},u=t.map(d=>{let v=d.horarioAsignadoEntradaManana||(d.horaEntradaManana&&d.horaEntradaManana!=="---"?d.horaEntradaManana:null),k=d.horarioAsignadoSalidaManana||(d.horaSalidaManana&&d.horaSalidaManana!=="---"?d.horaSalidaManana:null),M=d.horarioAsignadoEntradaTarde||(d.horaEntradaTarde&&d.horaEntradaTarde!=="---"?d.horaEntradaTarde:null),y=d.horarioAsignadoSalidaTarde||(d.horaSalidaTarde&&d.horaSalidaTarde!=="---"?d.horaSalidaTarde:null),P={trabajadorId:d.trabajadorId,fecha:this.fechaSeleccionada,horaEntradaManana:v,horaSalidaManana:k,horaEntradaTarde:M,horaSalidaTarde:y,tipoMarcacion:"Falta",estado:"Falta",observaciones:"Marcado masivamente como falta"};return this.http.post(`${this.apiAsistencias}/marcar-falta`,P,{headers:c}).toPromise()});Promise.all(u).then(d=>{console.log(`\u274C ${d.length} trabajadores marcados como falta`),this.finalizarProcesamiento(),this.cerrarNotificacion(),this.mostrarNotificacion("success","\u2705 \xC9xito",`${e} trabajador(es) marcado(s) como FALTA`,4e3),setTimeout(()=>{requestAnimationFrame(()=>{this.cargarAsistencias()})},1e3)}).catch(d=>{console.error("\u274C Error al marcar todos como falta:",d),this.finalizarProcesamiento(),this.cerrarNotificacion(),this.mostrarNotificacion("error","\u274C Error","Error al marcar trabajadores: "+(d.error?.message||d.message),4e3)})})}marcarFalta(t){this.mostrarConfirmacion("Marcar como Falta",`\xBFDeseas marcar a <strong>${t.trabajadorNombre}</strong> como FALTA?`,"danger",()=>{let e=t.horarioAsignadoEntradaManana||(t.horaEntradaManana&&t.horaEntradaManana!=="---"?t.horaEntradaManana:null),i=t.horarioAsignadoSalidaManana||(t.horaSalidaManana&&t.horaSalidaManana!=="---"?t.horaSalidaManana:null),c=t.horarioAsignadoEntradaTarde||(t.horaEntradaTarde&&t.horaEntradaTarde!=="---"?t.horaEntradaTarde:null),u=t.horarioAsignadoSalidaTarde||(t.horaSalidaTarde&&t.horaSalidaTarde!=="---"?t.horaSalidaTarde:null),d={trabajadorId:t.trabajadorId,fecha:this.fechaSeleccionada,horaEntradaManana:e,horaSalidaManana:i,horaEntradaTarde:c,horaSalidaTarde:u,tipoMarcacion:"Falta",estado:"Falta",observaciones:"Marcado manualmente como falta"};console.log("\u274C Marcando falta:",d),this.iniciarProcesamiento("marcar-falta",this.obtenerIdRegistro(t)),this.mostrarNotificacion("loading","Procesando...",`Marcando a ${t.trabajadorNombre} como falta`,0);let v=localStorage.getItem("token"),k=v?{Authorization:`Bearer ${v}`}:{};this.http.post(`${this.apiAsistencias}/marcar-falta`,d,{headers:k}).subscribe({next:M=>{console.log("\u274C Marcado como falta:",M),this.actualizarRegistroLocal(t.trabajadorId,{estado:"Falta",tipoMarcacion:"Falta",horaEntradaManana:null,horaSalidaManana:null,horaEntradaTarde:null,horaSalidaTarde:null}),this.finalizarProcesamiento(),this.cerrarNotificacion(),this.mostrarNotificacion("success","\u2705 \xC9xito",`${t.trabajadorNombre} marcado como FALTA`,3e3),this.actualizarResumenDesdeRegistros(),this.cdr.detectChanges()},error:M=>{console.error("\u274C Error al marcar falta:",M),this.finalizarProcesamiento(),this.cerrarNotificacion(),this.mostrarNotificacion("error","\u274C Error","Error al marcar falta: "+(M.error?.message||M.message),4e3)}})})}abrirModalEdicion(t){this.registroSeleccionado=U(V({},t),{horaEntradaManana:t.horaEntradaManana&&t.horaEntradaManana!=="---"?t.horaEntradaManana:t.horarioAsignadoEntradaManana||"",horaSalidaManana:t.horaSalidaManana&&t.horaSalidaManana!=="---"?t.horaSalidaManana:t.horarioAsignadoSalidaManana||"",horaEntradaTarde:t.horaEntradaTarde&&t.horaEntradaTarde!=="---"?t.horaEntradaTarde:t.horarioAsignadoEntradaTarde||"",horaSalidaTarde:t.horaSalidaTarde&&t.horaSalidaTarde!=="---"?t.horaSalidaTarde:t.horarioAsignadoSalidaTarde||""}),this.mostrarModalEdicion=!0,console.log("\u{1F4DD} Modal abierto con datos:",this.registroSeleccionado)}guardarEdicion(){if(!this.registroSeleccionado)return;console.log("\u{1F4BE} Guardando edici\xF3n:",this.registroSeleccionado);let t=!!(this.registroSeleccionado.horaEntradaManana?.trim()||this.registroSeleccionado.horaEntradaTarde?.trim()),e=this.registroSeleccionado.tipoMarcacion,i=e,c=this.registroSeleccionado.estado;!e&&t?(i="Presente",c="Presente"):e&&(i=e,c=this.registroSeleccionado.estado);let u=this.registroSeleccionado.horarioAsignadoEntradaManana||this.registroSeleccionado.horaEntradaManana||null,d=this.registroSeleccionado.horarioAsignadoSalidaManana||this.registroSeleccionado.horaSalidaManana||null,v=this.registroSeleccionado.horarioAsignadoEntradaTarde||this.registroSeleccionado.horaEntradaTarde||null,k=this.registroSeleccionado.horarioAsignadoSalidaTarde||this.registroSeleccionado.horaSalidaTarde||null,M=this.registroSeleccionado.horaEntradaManana?.trim()||u||null,y=this.registroSeleccionado.horaSalidaManana?.trim()||d||null,P=this.registroSeleccionado.horaEntradaTarde?.trim()||v||null,f=this.registroSeleccionado.horaSalidaTarde?.trim()||k||null,C={trabajadorId:this.registroSeleccionado.trabajadorId,fecha:this.fechaSeleccionada,horaEntradaManana:M&&M!=="---"?M:null,horaSalidaManana:y&&y!=="---"?y:null,horaEntradaTarde:P&&P!=="---"?P:null,horaSalidaTarde:f&&f!=="---"?f:null,estado:c,tipoMarcacion:i||"Manual",observaciones:this.registroSeleccionado.observaciones?.trim()||null};console.log("\u{1F4E4} Datos a enviar:",C);let R=localStorage.getItem("token"),S=R?{Authorization:`Bearer ${R}`}:{};this.iniciarProcesamiento("editar-horarios",this.obtenerIdRegistro(this.registroSeleccionado)),this.mostrarNotificacion("loading","Procesando...",`Actualizando horarios de ${this.registroSeleccionado?.trabajadorNombre}`,0),this.http.post(`${this.apiAsistencias}/actualizar`,C,{headers:S}).subscribe({next:D=>{if(console.log("\u2705 Asistencia actualizada:",D),M&&M!=="---"&&y&&y!=="---"){let A={horarioHabitualEntradaManana:M,horarioHabitualSalidaManana:y,horarioHabitualEntradaTarde:P&&P!=="---"?P:null,horarioHabitualSalidaTarde:f&&f!=="---"?f:null};console.log("\u{1F4BE} Actualizando horario habitual del trabajador:",A),this.http.put(`${this.apiTrabajadores}/${this.registroSeleccionado.trabajadorId}`,A,{headers:S}).subscribe({next:F=>{console.log("\u2705 Horario habitual actualizado:",F),this.finalizarProcesamiento(),this.cerrarNotificacion(),this.mostrarNotificacion("success","\u2705 \xC9xito","Horarios guardados permanentemente",3e3),this.mostrarModalEdicion=!1,this.registroSeleccionado=null,setTimeout(()=>{requestAnimationFrame(()=>{this.cargarAsistencias()})},1e3)},error:F=>{console.error("\u26A0\uFE0F Error al actualizar horario habitual (pero asistencia guardada):",F),this.finalizarProcesamiento(),this.cerrarNotificacion(),this.mostrarNotificacion("success","\u2705 \xC9xito","Asistencia actualizada (horario habitual no se pudo actualizar)",3e3),this.mostrarModalEdicion=!1,this.registroSeleccionado=null,setTimeout(()=>{requestAnimationFrame(()=>{this.cargarAsistencias()})},1e3)}})}else this.finalizarProcesamiento(),this.cerrarNotificacion(),this.mostrarNotificacion("success","\u2705 \xC9xito","Asistencia actualizada exitosamente",3e3),this.mostrarModalEdicion=!1,this.registroSeleccionado=null,setTimeout(()=>{requestAnimationFrame(()=>{this.cargarAsistencias()})},1e3)},error:D=>{console.error("\u274C Error al actualizar asistencia:",D),this.finalizarProcesamiento(),this.cerrarNotificacion(),this.mostrarNotificacion("error","\u274C Error","Error al actualizar: "+(D.error?.message||D.message),4e3)}})}abrirModalHorariosMasivos(){this.formHorariosMasivos={tipoAsignacion:"todos",regimenLaboralId:null,horaEntradaManana:"08:00",horaSalidaManana:"13:00",horaEntradaTarde:"14:00",horaSalidaTarde:"17:00"},this.mostrarModalHorariosMasivos=!0}guardarHorariosMasivos(){if(!this.formHorariosMasivos.horaEntradaManana||!this.formHorariosMasivos.horaSalidaManana){this.mostrarNotificacion("error","\u274C Error","Debe completar al menos los horarios de ma\xF1ana",3e3);return}if(this.formHorariosMasivos.tipoAsignacion==="regimen"&&!this.formHorariosMasivos.regimenLaboralId){this.mostrarNotificacion("error","\u274C Error","Debe seleccionar un r\xE9gimen laboral",3e3);return}let t=this.formHorariosMasivos.tipoAsignacion==="todos"?"\xBFDeseas asignar este horario a <strong>TODOS</strong> los trabajadores activos?":"\xBFDeseas asignar este horario a todos los trabajadores del r\xE9gimen laboral seleccionado?";this.mostrarConfirmacion("Asignar Horarios Masivamente",t,"warning",()=>{let e={tipoAsignacion:this.formHorariosMasivos.tipoAsignacion,regimenLaboralId:this.formHorariosMasivos.regimenLaboralId||null,horarioHabitualEntradaManana:this.formHorariosMasivos.horaEntradaManana,horarioHabitualSalidaManana:this.formHorariosMasivos.horaSalidaManana,horarioHabitualEntradaTarde:this.formHorariosMasivos.horaEntradaTarde||null,horarioHabitualSalidaTarde:this.formHorariosMasivos.horaSalidaTarde||null};console.log("\u{1F4BE} Asignando horarios masivamente:",e),this.iniciarProcesamiento("horarios-masivos","masivo"),this.mostrarNotificacion("loading","Procesando...","Asignando horarios a los trabajadores...",0);let i=localStorage.getItem("token"),c=i?{Authorization:`Bearer ${i}`}:{};this.http.post(`${this.apiTrabajadores}/asignar-horarios-masivo`,e,{headers:c}).subscribe({next:u=>{console.log("\u2705 Horarios asignados masivamente:",u),this.finalizarProcesamiento(),this.cerrarNotificacion();let d=u.data?.trabajadoresAfectados||0;this.mostrarNotificacion("success","\u2705 \xC9xito",`Horarios asignados a ${d} trabajador(es)`,4e3),this.mostrarModalHorariosMasivos=!1,this.trabajadoresActivos=[],setTimeout(()=>{console.log("\u{1F504} Recargando asistencias despu\xE9s de asignaci\xF3n masiva..."),requestAnimationFrame(()=>{this.cargarAsistencias()})},1e3)},error:u=>{console.error("\u274C Error al asignar horarios masivamente:",u),this.finalizarProcesamiento(),this.cerrarNotificacion(),this.mostrarNotificacion("error","\u274C Error","Error al asignar horarios: "+(u.error?.message||u.message),4e3)}})})}obtenerIdRegistro(t){return t.id||t.trabajadorDni||""}toggleMenuAcciones(t,e){e&&(e.stopPropagation(),e.preventDefault()),this.menuAbiertoId===t?this.cerrarMenuAcciones():(this.menuAbiertoId=t,setTimeout(()=>{this.ajustarPosicionDropdown()},10))}cerrarMenuAcciones(){this.menuAbiertoId=null}ajustarPosicionDropdown(){let t=document.querySelector(".actions-dropdown--open .dropdown-menu");if(!t)return;let e=document.querySelector(".actions-dropdown--open");if(!e)return;let i=e.getBoundingClientRect(),c=window.innerWidth,u=window.innerHeight,d=i.bottom+8,v=c-i.right;t.style.position="fixed",t.style.top=`${d}px`,t.style.right=`${v}px`,t.style.left="auto",t.style.bottom="auto",t.style.zIndex="999999",setTimeout(()=>{let k=t.getBoundingClientRect();k.right>c&&(t.style.right="auto",t.style.left=`${i.left}px`),k.bottom>u&&(t.style.top="auto",t.style.bottom=`${u-i.top+8}px`)},0)}onClickOutside(t){let e=t.target;e.closest(".actions-dropdown")||e.closest(".dropdown-menu")||e.closest(".dropdown-item")||e.closest(".btn-icon--primary")||e.classList.contains("dropdown-item")||e.classList.contains("dropdown-menu")||e.closest("button.dropdown-item")||setTimeout(()=>{this.cerrarMenuAcciones()},150)}mostrarNotificacion(t,e,i,c=3e3){this.notificacion={mostrar:!0,tipo:t,titulo:e,mensaje:i,duracion:c},t!=="loading"&&c>0&&setTimeout(()=>{this.cerrarNotificacion()},c)}cerrarNotificacion(){this.notificacion.mostrar=!1}mostrarConfirmacion(t,e,i,c,u){console.log("\u{1F535} mostrarConfirmacion llamado:",t),this.confirmacion={mostrar:!0,titulo:t,mensaje:e,tipo:i,onConfirm:c,onCancel:u},console.log("\u{1F535} confirmacion.mostrar:",this.confirmacion.mostrar)}confirmarAccion(){console.log("\u{1F535} confirmarAccion llamado");let t=this.confirmacion.onConfirm;this.confirmacion.mostrar=!1,t&&(console.log("\u{1F535} Ejecutando onConfirm"),t())}cancelarAccion(){console.log("\u{1F535} cancelarAccion llamado");let t=this.confirmacion.onCancel;this.confirmacion.mostrar=!1,t&&t()}iniciarProcesamiento(t,e){this.procesandoAccion={tipo:t,registroId:e}}finalizarProcesamiento(){this.procesandoAccion={tipo:null,registroId:null}}formatearMensajeNotificacion(t){if(!t)return this.sanitizer.bypassSecurityTrustHtml("");let e=t.replace(/\bFALTA\b/gi,'<span class="notificacion__palabra-destacada notificacion__palabra-destacada--rojo">FALTA</span>');return this.sanitizer.bypassSecurityTrustHtml(e)}obtenerFeriadosPeru(t){let e=[];e.push(new Date(t,0,1)),e.push(new Date(t,4,1)),e.push(new Date(t,6,28)),e.push(new Date(t,6,29)),e.push(new Date(t,7,30)),e.push(new Date(t,9,8)),e.push(new Date(t,10,1)),e.push(new Date(t,11,8)),e.push(new Date(t,11,25));let i=t%19,c=Math.floor(t/100),u=t%100,d=Math.floor(c/4),v=c%4,k=Math.floor((c+8)/25),M=Math.floor((c-k+1)/3),y=(19*i+c-d-M+15)%30,P=Math.floor(u/4),f=u%4,C=(32+2*v+2*P-y-f)%7,R=Math.floor((i+11*y+22*C)/451),S=Math.floor((y+C-7*R+114)/31)-1,D=(y+C-7*R+114)%31+1,A=new Date(t,S,D);A.setHours(0,0,0,0);let F=new Date(A);F.setDate(A.getDate()-3),e.push(F);let $=new Date(A);return $.setDate(A.getDate()-2),e.push($),e.map(Y=>{let J=new Date(Y);return J.setHours(0,0,0,0),J})}esFeriado(t,e){let i=new Date(t.getFullYear(),t.getMonth(),t.getDate());return e.some(c=>new Date(c.getFullYear(),c.getMonth(),c.getDate()).getTime()===i.getTime())}parsearFecha(t){if(!t)return new Date;let e=t.split("-");if(e.length===3){let c=parseInt(e[0],10),u=parseInt(e[1],10)-1,d=parseInt(e[2],10);return isNaN(c)||isNaN(u)||isNaN(d)?(console.error("\u274C Error al parsear fecha:",t),new Date):new Date(c,u,d,12,0,0)}let i=new Date(t);return isNaN(i.getTime())?(console.error("\u274C Error al parsear fecha:",t),new Date):i}esDiaNoHabil(){if(!this.fechaSeleccionada)return!1;if(this._esDiaNoHabilCache&&this._esDiaNoHabilCache.fecha===this.fechaSeleccionada)return this._esDiaNoHabilCache.resultado;let t=this.parsearFecha(this.fechaSeleccionada);if(isNaN(t.getTime()))return console.error("\u274C Fecha inv\xE1lida:",this.fechaSeleccionada),this._esDiaNoHabilCache={fecha:this.fechaSeleccionada,resultado:!1},!1;let e=t.getDay(),i=t.toLocaleDateString("es-PE",{weekday:"long"}),c=t.toLocaleDateString("es-PE"),u=!1;if(e===0||e===6)(!this._esDiaNoHabilCache||this._esDiaNoHabilCache.fecha!==this.fechaSeleccionada)&&console.log(`\u{1F4C5} ${c} (${i}) es d\xEDa NO H\xC1BIL (fin de semana)`),u=!0;else{let d=t.getFullYear(),v=this.obtenerFeriadosPeru(d);this.esFeriado(t,v)?((!this._esDiaNoHabilCache||this._esDiaNoHabilCache.fecha!==this.fechaSeleccionada)&&console.log(`\u{1F4C5} ${c} (${i}) es d\xEDa NO H\xC1BIL (feriado)`),u=!0):((!this._esDiaNoHabilCache||this._esDiaNoHabilCache.fecha!==this.fechaSeleccionada)&&console.log(`\u{1F4C5} ${c} (${i}) es d\xEDa H\xC1BIL`),u=!1)}return this._esDiaNoHabilCache={fecha:this.fechaSeleccionada,resultado:u},u}};h.\u0275fac=function(e){return new(e||h)(H(se),H(oe),H(re),H(ee))},h.\u0275cmp=Q({type:h,selectors:[["app-registro"]],hostBindings:function(e,i){e&1&&b("click",function(u){return i.onClickOutside(u)},K)},decls:94,vars:38,consts:[[1,"registro-asistencia"],[1,"page-header"],[1,"page-header__left"],[1,"page-title"],[1,"page-title__icon"],[1,"page-title__text"],[1,"page-subtitle"],[1,"page-subtitle__dots"],[1,"page-subtitle__dot","page-subtitle__dot--large"],[1,"page-subtitle__dot","page-subtitle__dot--medium"],[1,"page-subtitle__dot","page-subtitle__dot--small"],[1,"page-header__right"],[1,"reloj-digital"],[1,"reloj-digital__time"],[1,"reloj-digital__hora"],[1,"reloj-digital__separador"],[1,"reloj-digital__minutos"],[1,"reloj-digital__segundos"],[1,"reloj-digital__ampm"],[1,"reloj-digital__date"],[1,"reloj-digital__dia-semana"],[1,"reloj-digital__fecha-completa"],["class","resumen-diario",4,"ngIf"],[1,"fecha-navigation"],[1,"fecha-navigation__controls"],["title","D\xEDa anterior",1,"btn-nav",3,"click"],[1,"fecha-selector"],["type","date",1,"fecha-input",3,"ngModelChange","change","ngModel"],[1,"btn","btn--sm","btn--accent",3,"click"],["title","D\xEDa siguiente",1,"btn-nav",3,"click"],[1,"fecha-navigation__actions"],[1,"btn","btn--sm","btn--outline",3,"click"],[1,"btn","btn--sm",3,"click","title"],[4,"ngIf"],["title","Asignar horarios masivamente",1,"btn","btn--sm","btn--accent",3,"click"],[1,"btn","btn--sm","btn--primary",3,"click"],[1,"filtros-bar"],[1,"filtros-bar__left"],[1,"search-box"],[1,"search-box__icon"],["type","text","placeholder","Buscar por DNI, nombre, \xE1rea...",1,"search-box__input",3,"ngModelChange","input","ngModel"],[1,"select",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","btn btn--ghost btn--sm",3,"click",4,"ngIf"],[1,"filtros-bar__right"],[1,"btn-icon-export",3,"click"],["src","assets/excel.png","alt","Excel",1,"btn-icon-export__icon"],[1,"btn-icon-export__text"],["src","assets/pdf.png","alt","PDF",1,"btn-icon-export__icon"],["class","tabla-container",4,"ngIf"],["class","tarjetas-container",4,"ngIf"],["class","modal",3,"click",4,"ngIf"],["class","notificacion-container",4,"ngIf"],["class","modal-overlay modal-confirmacion",3,"click",4,"ngIf"],[1,"resumen-diario"],[1,"resumen-card","resumen-card--total"],[1,"resumen-card__icon"],[1,"resumen-card__content"],[1,"resumen-card__label"],[1,"resumen-card__value"],[1,"resumen-card","resumen-card--presente"],[1,"resumen-card","resumen-card--tardanza"],[1,"resumen-card","resumen-card--falta"],[1,"resumen-card","resumen-card--permiso"],[1,"resumen-card","resumen-card--licencia"],[1,"resumen-card","resumen-card--asistencia"],[3,"value"],[1,"btn","btn--ghost","btn--sm",3,"click"],[1,"tabla-container"],[1,"tabla-scroll"],[1,"tabla"],[3,"highlight","dia-no-habil",4,"ngFor","ngForOf"],["colspan","11",1,"td-loading"],[1,"loading-spinner"],["colspan","11",1,"td-empty"],[1,"empty-state"],[1,"empty-state__icon"],[1,"empty-state__text"],[1,"td-dni"],[1,"td-trabajador"],[1,"trabajador-info"],[1,"trabajador-info__nombre"],[1,"trabajador-info__cargo"],[1,"td-area"],[1,"td-hora"],["class","retraso-badge",4,"ngIf"],[1,"td-estado"],[1,"badge",3,"ngClass"],[1,"td-tiempo"],[1,"tiempo-trabajado"],["class","horas-extras",4,"ngIf"],[1,"td-justificacion"],["class","justificacion-icon","title","Tiene justificaci\xF3n",4,"ngIf"],["class","justificacion-icon justificacion-icon--no","title","Sin justificaci\xF3n",4,"ngIf"],[1,"td-actions"],[1,"actions-menu"],["class","btn-icon btn-icon--success","title","Marcar Presente","type","button",3,"click",4,"ngIf"],["class","btn-icon btn-icon--danger","title","Marcar Falta","type","button",3,"click",4,"ngIf"],["class","btn-icon btn-icon--warning","title","Marcar Tardanza","type","button",3,"click",4,"ngIf"],["class","btn-icon btn-icon--info","title","Marcar Permiso","type","button",3,"click",4,"ngIf"],["class","btn-icon btn-icon--info","title","Marcar Licencia","type","button",3,"click",4,"ngIf"],["title","Editar Horarios","type","button",1,"btn-icon","btn-icon--primary",3,"click"],["title","Justificar","type","button",1,"btn-icon","btn-icon--primary",3,"click"],[1,"retraso-badge"],[1,"horas-extras"],["title","Tiene justificaci\xF3n",1,"justificacion-icon"],["title","Sin justificaci\xF3n",1,"justificacion-icon","justificacion-icon--no"],["title","Marcar Presente","type","button",1,"btn-icon","btn-icon--success",3,"click"],["title","Marcar Falta","type","button",1,"btn-icon","btn-icon--danger",3,"click"],["title","Marcar Tardanza","type","button",1,"btn-icon","btn-icon--warning",3,"click"],["title","Marcar Permiso","type","button",1,"btn-icon","btn-icon--info",3,"click"],["title","Marcar Licencia","type","button",1,"btn-icon","btn-icon--info",3,"click"],[1,"tarjetas-container"],["class","tarjeta-asistencia",3,"tarjeta-asistencia--falta",4,"ngFor","ngForOf"],[1,"tarjeta-asistencia"],[1,"tarjeta-asistencia__header"],[1,"tarjeta-asistencia__trabajador"],[1,"avatar"],[1,"info"],[1,"nombre"],[1,"cargo"],[1,"area"],[1,"tarjeta-asistencia__body"],[1,"marcacion-grid"],[1,"marcacion-item"],[1,"marcacion-item__label"],[1,"marcacion-item__hora"],[1,"estadisticas-grid"],[1,"stat-item"],[1,"stat-item__icon"],[1,"stat-item__content"],[1,"stat-item__label"],[1,"stat-item__value"],["class","stat-item",4,"ngIf"],["class","justificacion-info",4,"ngIf"],["class","observaciones-info",4,"ngIf"],[1,"tarjeta-asistencia__footer"],[1,"footer-actions"],["class","btn btn--sm btn--success",3,"click",4,"ngIf"],["class","btn btn--sm btn--danger",3,"click",4,"ngIf"],[1,"btn","btn--sm","btn--warning",3,"click"],[1,"tipo-marcacion"],[1,"justificacion-info"],[1,"justificacion-info__icon"],[1,"justificacion-info__content"],[1,"justificacion-info__label"],[1,"justificacion-info__texto"],[1,"observaciones-info"],[1,"observaciones-info__icon"],[1,"observaciones-info__texto"],[1,"btn","btn--sm","btn--success",3,"click"],[1,"btn","btn--sm","btn--danger",3,"click"],[1,"modal",3,"click"],[1,"modal__content",3,"click"],[1,"modal__header"],[1,"modal__title"],[1,"modal__close",3,"click"],[1,"modal__body"],[1,"modal__info"],[1,"form-grid"],[1,"form-group","form-group--full"],[1,"form-label"],["required","",1,"form-select",3,"ngModelChange","ngModel"],[1,"form-group"],["type","time",1,"form-input",3,"ngModelChange","ngModel"],["value","Presente"],["value","Tardanza"],["value","Falta"],["value","Permiso"],["value","Licencia"],["value","Vacaciones"],["value","Comision"],["placeholder","Motivo de la ausencia o tardanza...",1,"form-textarea",3,"ngModelChange","ngModel"],["rows","3","placeholder","Ingrese observaciones...",1,"form-textarea"],[1,"modal__footer"],[1,"btn","btn--ghost",3,"click"],[1,"btn","btn--primary",3,"click"],["class","modal__body",4,"ngIf"],[1,"trabajador-selected"],[1,"form-select",3,"ngModelChange","ngModel"],["rows","3","placeholder","Observaciones adicionales...",1,"form-textarea",3,"ngModelChange","ngModel"],[1,"btn","btn--accent",3,"click"],["type","file","accept",".pdf,.jpg,.png",1,"form-input"],[1,"form-hint"],["rows","4","placeholder","Detalles adicionales...",1,"form-textarea"],[1,"btn","btn--orange",3,"click"],["type","time","required","",1,"form-input",3,"ngModelChange","ngModel"],["type","number","min","0","placeholder","Minutos",1,"form-input",3,"ngModelChange","ngModel"],["rows","3","placeholder","Motivo de la tardanza...",1,"form-textarea",3,"ngModelChange","ngModel"],[1,"btn","btn--purple",3,"click"],["value","Medio d\xEDa"],["value","Todo el d\xEDa"],["value","Horas espec\xEDficas"],["class","form-group",4,"ngIf"],["type","text","placeholder","Ej: Tr\xE1mite personal, Emergencia familiar...","required","",1,"form-input",3,"ngModelChange","ngModel"],["rows","3","placeholder","Detalles adicionales...",1,"form-textarea",3,"ngModelChange","ngModel"],["type","number","min","1","max","8","placeholder","Horas",1,"form-input",3,"ngModelChange","ngModel"],[1,"btn","btn--cyan",3,"click"],["value","Con goce de haber"],["value","Sin goce de haber"],["value","Licencia m\xE9dica"],["value","Licencia por maternidad"],["value","Licencia por paternidad"],["type","number","min","1","max","365","required","",1,"form-input",3,"ngModelChange","ngModel"],["type","text","placeholder","Ej: Enfermedad, Maternidad, Paternidad...","required","",1,"form-input",3,"ngModelChange","ngModel"],["rows","3","placeholder","Detalles adicionales, n\xFAmero de documento m\xE9dico si aplica...",1,"form-textarea",3,"ngModelChange","ngModel"],[1,"notificacion-container"],[1,"notificacion",3,"ngClass"],[1,"notificacion__icon"],["class","spinner",4,"ngIf"],[1,"notificacion__content"],[1,"notificacion__titulo"],[1,"notificacion__mensaje",3,"innerHTML"],["class","notificacion__close",3,"click",4,"ngIf"],[1,"spinner"],[1,"spinner__circle"],[1,"notificacion__close",3,"click"],[1,"modal-overlay","modal-confirmacion",3,"click"],[1,"modal-confirmacion__content",3,"click"],[1,"modal-confirmacion__header",3,"ngClass"],[1,"modal-confirmacion__icon"],[1,"modal-confirmacion__titulo"],[1,"modal-confirmacion__body"],[1,"modal-confirmacion__mensaje",3,"innerHTML"],[1,"modal-confirmacion__footer"],[1,"btn",3,"click","ngClass"],[1,"modal__content","modal__content--large",3,"click"],[1,"form-select",3,"ngModelChange","change","ngModel"],["value","todos"],["value","regimen"],["class","form-group form-group--full",4,"ngIf"],[1,"form-divider"],[1,"form-section-title"],[1,"alert","alert--info",2,"margin-top","20px"],[1,"btn","btn--primary",3,"click","disabled"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3)(4,"span",4),r(5,"\u{1F4CB}"),o(),n(6,"span",5),r(7,"Registro de Asistencias"),o()(),n(8,"p",6)(9,"span",7),I(10,"span",8)(11,"span",9)(12,"span",10),o(),r(13," Control diario de asistencia del personal municipal "),o()(),n(14,"div",11)(15,"div",12)(16,"div",13)(17,"span",14),r(18),o(),n(19,"span",15),r(20,":"),o(),n(21,"span",16),r(22),o(),n(23,"span",15),r(24,":"),o(),n(25,"span",17),r(26),o(),n(27,"span",18),r(28),o()(),n(29,"div",19)(30,"span",20),r(31),o(),n(32,"span",21),r(33),o()()()()(),O(34,ve,57,7,"div",22),n(35,"div",23)(36,"div",24)(37,"button",25),b("click",function(){return i.cambiarFecha(-1)}),n(38,"span"),r(39,"\u25C0\uFE0F"),o()(),n(40,"div",26)(41,"input",27),T("ngModelChange",function(u){return w(i.fechaSeleccionada,u)||(i.fechaSeleccionada=u),u}),b("change",function(){return i.cargarAsistencias()}),o(),n(42,"button",28),b("click",function(){return i.irHoy()}),r(43," \u{1F4C5} Hoy "),o()(),n(44,"button",29),b("click",function(){return i.cambiarFecha(1)}),n(45,"span"),r(46,"\u25B6\uFE0F"),o()()(),n(47,"div",30)(48,"button",31),b("click",function(){return i.vistaActual="lista"}),r(49," \u{1F4CB} Lista "),o(),n(50,"button",31),b("click",function(){return i.vistaActual="tarjetas"}),r(51," \u{1F3B4} Tarjetas "),o(),n(52,"button",32),b("click",function(){return i.todosEstanPresentes()?i.marcarTodosFalta():i.marcarTodosPresentes()}),O(53,Ce,2,0,"span",33)(54,Se,2,0,"span",33),o(),n(55,"button",34),b("click",function(){return i.abrirModalHorariosMasivos()}),r(56," \u23F0 Asignar Horarios "),o(),n(57,"button",35),b("click",function(){return i.abrirModalRegistro()}),r(58," \u2795 Registro Manual "),o()()(),n(59,"div",36)(60,"div",37)(61,"div",38)(62,"span",39),r(63,"\u{1F50D}"),o(),n(64,"input",40),T("ngModelChange",function(u){return w(i.filtros.busqueda,u)||(i.filtros.busqueda=u),u}),b("input",function(){return i.aplicarFiltros()}),o()(),n(65,"select",41),T("ngModelChange",function(u){return w(i.filtros.estado,u)||(i.filtros.estado=u),u}),b("change",function(){return i.aplicarFiltros()}),n(66,"option",42),r(67,"Todos los estados"),o(),O(68,Pe,2,2,"option",43),o(),n(69,"select",41),T("ngModelChange",function(u){return w(i.filtros.regimenLaboral,u)||(i.filtros.regimenLaboral=u),u}),b("change",function(){return i.aplicarFiltros()}),n(70,"option",42),r(71,"Todos los reg\xEDmenes"),o(),O(72,Ee,2,2,"option",43),o(),O(73,we,2,0,"button",44),o(),n(74,"div",45)(75,"button",46),b("click",function(){return i.exportarExcel()}),I(76,"img",47),n(77,"span",48),r(78,"Excel"),o()(),n(79,"button",46),b("click",function(){return i.exportarPDF()}),I(80,"img",49),n(81,"span",48),r(82,"PDF"),o()()()(),O(83,Ne,31,3,"div",50)(84,Ye,2,1,"div",51)(85,Ge,65,8,"div",52)(86,Ze,13,1,"div",52)(87,et,13,1,"div",52)(88,at,13,1,"div",52)(89,ot,13,1,"div",52)(90,st,13,1,"div",52)(91,ft,13,10,"div",53)(92,xt,17,9,"div",54)(93,Pt,47,9,"div",52),o()),e&2&&(s(18),x(i.horaCompleta),s(4),x(i.minutos),s(4),x(i.segundos),s(2),x(i.ampm),s(3),x(i.diaSemana),s(2),X("",i.diaMes," de ",i.mesNombre,", ",i.anio),s(),_("ngIf",i.resumenDiario),s(7),E("ngModel",i.fechaSeleccionada),s(7),N("active",i.vistaActual==="lista"),s(2),N("active",i.vistaActual==="tarjetas"),s(2),N("btn--success",!i.todosEstanPresentes())("btn--danger",i.todosEstanPresentes()),_("title",i.todosEstanPresentes()?"Marcar a todos los trabajadores como falta":"Marcar a todos los trabajadores como presentes"),s(),_("ngIf",!i.todosEstanPresentes()),s(),_("ngIf",i.todosEstanPresentes()),s(10),E("ngModel",i.filtros.busqueda),s(),E("ngModel",i.filtros.estado),s(3),_("ngForOf",i.estados),s(),E("ngModel",i.filtros.regimenLaboral),s(3),_("ngForOf",i.regimenesLaborales),s(),_("ngIf",i.filtros.busqueda||i.filtros.estado||i.filtros.regimenLaboral),s(10),_("ngIf",i.vistaActual==="lista"),s(),_("ngIf",i.vistaActual==="tarjetas"),s(),_("ngIf",i.mostrarModalRegistro),s(),_("ngIf",i.mostrarModalEdicion),s(),_("ngIf",i.mostrarModalJustificacion),s(),_("ngIf",i.mostrarModalTardanza),s(),_("ngIf",i.mostrarModalPermiso),s(),_("ngIf",i.mostrarModalLicencia),s(),_("ngIf",i.notificacion.mostrar),s(),_("ngIf",i.confirmacion.mostrar),s(),_("ngIf",i.mostrarModalHorariosMasivos))},dependencies:[ie,te,ae,ne,be,ge,fe,ce,me,pe,le,he,ue,_e,de],styles:['@charset "UTF-8";.registro-asistencia[_ngcontent-%COMP%]{width:100%;max-width:100%;padding-bottom:20px}.page-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;margin-top:0;padding:16px 20px;background:linear-gradient(135deg,#fff,#f8fafc)!important;border-radius:10px;border:1px solid rgba(34,197,94,.15);box-shadow:0 4px 16px #00000014,0 1px 3px #0000000d,inset 0 1px #ffffffe6;position:relative;overflow:hidden}.page-header[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,#22c55e,#16a34a,#22c55e);background-size:200% 100%;animation:_ngcontent-%COMP%_shimmer 3s ease-in-out infinite}.page-header[_ngcontent-%COMP%]:after{content:"";position:absolute;top:0;left:0;width:4px;height:100%;background:linear-gradient(180deg,#22c55e,#16a34a);opacity:.6}.page-header__left[_ngcontent-%COMP%]{flex:1;position:relative;z-index:1;padding-left:12px}.page-header__right[_ngcontent-%COMP%]{flex-shrink:0;position:relative;z-index:1}[data-theme=dark][_nghost-%COMP%]   .page-header[_ngcontent-%COMP%], [data-theme=dark]   [_nghost-%COMP%]   .page-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1e293b,#0f172a)!important;border:1px solid rgba(34,197,94,.2);box-shadow:0 4px 16px #0000004d,0 1px 3px #0003,inset 0 1px #ffffff0d}[data-theme=dark][_nghost-%COMP%]   .page-title[_ngcontent-%COMP%], [data-theme=dark]   [_nghost-%COMP%]   .page-title[_ngcontent-%COMP%]{color:#e2e8f0!important}[data-theme=dark][_nghost-%COMP%]   .page-title__text[_ngcontent-%COMP%], [data-theme=dark]   [_nghost-%COMP%]   .page-title__text[_ngcontent-%COMP%]{color:#e2e8f0!important}[data-theme=dark][_nghost-%COMP%]   .page-subtitle[_ngcontent-%COMP%], [data-theme=dark]   [_nghost-%COMP%]   .page-subtitle[_ngcontent-%COMP%]{color:#94a3b8!important}[data-theme=dark][_nghost-%COMP%]   .fecha-navigation[_ngcontent-%COMP%], [data-theme=dark]   [_nghost-%COMP%]   .fecha-navigation[_ngcontent-%COMP%], [data-theme=dark][_nghost-%COMP%]   .filtros-bar[_ngcontent-%COMP%], [data-theme=dark]   [_nghost-%COMP%]   .filtros-bar[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--panel) 0%,#1e293b 100%)!important;border-color:var(--border);box-shadow:0 4px 16px #0000004d,0 1px 3px #0003,inset 0 1px #ffffff0d}[data-theme=dark][_nghost-%COMP%]   .tabla[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%], [data-theme=dark]   [_nghost-%COMP%]   .tabla[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:#1e293b!important}[data-theme=dark][_nghost-%COMP%]   .tabla[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], [data-theme=dark]   [_nghost-%COMP%]   .tabla[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#1e293b!important;color:#e2e8f0!important;border-bottom:2px solid #334155!important;border-right:1px solid rgba(255,255,255,.05)!important}@keyframes _ngcontent-%COMP%_shimmer{0%,to{background-position:0% 50%}50%{background-position:100% 50%}}.page-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;font-size:24px;font-weight:800;margin:0 0 6px;letter-spacing:-.02em;line-height:1.2;color:#1e293b}.page-title__icon[_ngcontent-%COMP%]{font-size:28px;filter:drop-shadow(0 2px 4px rgba(34,197,94,.4));display:inline-flex;align-items:center;justify-content:center;width:40px;height:40px;background:linear-gradient(135deg,#22c55e1a,#16a34a1a);border-radius:10px;flex-shrink:0;border:1px solid rgba(34,197,94,.2)}.page-title__text[_ngcontent-%COMP%]{color:#1e293b;font-weight:800;letter-spacing:-.02em}@keyframes _ngcontent-%COMP%_iconPulse{0%,to{transform:scale(1)}50%{transform:scale(1.05)}}.page-subtitle[_ngcontent-%COMP%]{font-size:11px;color:#64748b;margin:0;font-weight:600;letter-spacing:.05em;display:flex;align-items:center;gap:10px;text-transform:uppercase;position:relative;padding-left:20px}.page-subtitle__dots[_ngcontent-%COMP%]{position:absolute;left:0;top:50%;transform:translateY(-50%);display:flex;flex-direction:column;align-items:flex-start;justify-content:center;gap:3px;width:16px;height:20px}.page-subtitle__dot[_ngcontent-%COMP%]{border-radius:50%;background:linear-gradient(135deg,#22c55e,#16a34a);box-shadow:0 0 6px #22c55e80}.page-subtitle__dot--large[_ngcontent-%COMP%]{width:8px;height:8px;margin-left:0}.page-subtitle__dot--medium[_ngcontent-%COMP%]{width:5px;height:5px;margin-left:3px}.page-subtitle__dot--small[_ngcontent-%COMP%]{width:3px;height:3px;margin-left:6px}@keyframes _ngcontent-%COMP%_pulse{0%,to{transform:scale(1);opacity:1}50%{transform:scale(1.2);opacity:.8}}.reloj-digital[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;gap:6px;padding:14px 20px;background:linear-gradient(135deg,#22c55e,#16a34a,#15803d);border-radius:10px;box-shadow:0 6px 24px #22c55e66,0 3px 12px #22c55e40,inset 0 1px #fff3,inset 0 -1px #0000001a;position:relative;overflow:hidden;border:2px solid rgba(255,255,255,.15);min-width:220px}.reloj-digital[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:radial-gradient(circle at 50% 50%,rgba(255,255,255,.08) 0%,transparent 70%);pointer-events:none;animation:_ngcontent-%COMP%_subtleGlow 3s ease-in-out infinite}.reloj-digital[_ngcontent-%COMP%]:after{content:"";position:absolute;inset:0;background:radial-gradient(circle at 30% 30%,rgba(255,255,255,.06) 0%,transparent 50%);pointer-events:none}.reloj-digital__time[_ngcontent-%COMP%]{display:flex;align-items:baseline;gap:4px;position:relative;z-index:2}.reloj-digital__hora[_ngcontent-%COMP%]{font-size:32px;font-weight:800;color:#fff;font-family:SF Mono,Monaco,Courier New,monospace;letter-spacing:1.5px;text-shadow:0 2px 8px rgba(0,0,0,.35),0 0 15px rgba(255,255,255,.15),0 1px 2px rgba(0,0,0,.4);position:relative;line-height:1}.reloj-digital__separador[_ngcontent-%COMP%]{font-size:32px;font-weight:800;color:#ffffffe6;font-family:SF Mono,Monaco,Courier New,monospace;text-shadow:0 2px 6px rgba(0,0,0,.25);line-height:1}.reloj-digital__minutos[_ngcontent-%COMP%]{font-size:32px;font-weight:800;color:#fff;font-family:SF Mono,Monaco,Courier New,monospace;letter-spacing:1.5px;text-shadow:0 2px 8px rgba(0,0,0,.35),0 0 15px rgba(255,255,255,.15),0 1px 2px rgba(0,0,0,.4);line-height:1}.reloj-digital__segundos[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#fffffff2;font-family:SF Mono,Monaco,Courier New,monospace;letter-spacing:1px;text-shadow:0 2px 6px rgba(0,0,0,.25),0 0 12px rgba(255,255,255,.12);line-height:1}.reloj-digital__ampm[_ngcontent-%COMP%]{font-size:12px;font-weight:700;color:#ffffffe6;font-family:SF Mono,Monaco,Courier New,monospace;letter-spacing:.5px;text-transform:lowercase;margin-left:6px;text-shadow:0 1px 3px rgba(0,0,0,.25);line-height:1;padding-top:6px}.reloj-digital__date[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;gap:2px;position:relative;z-index:2}.reloj-digital__dia-semana[_ngcontent-%COMP%]{font-size:11px;font-weight:700;color:#fffffff2;text-transform:uppercase;letter-spacing:1px;text-shadow:0 1px 3px rgba(0,0,0,.25);font-family:Inter,-apple-system,BlinkMacSystemFont,sans-serif}.reloj-digital__fecha-completa[_ngcontent-%COMP%]{font-size:10px;font-weight:600;color:#ffffffd9;text-shadow:0 1px 2px rgba(0,0,0,.2);font-family:Inter,-apple-system,BlinkMacSystemFont,sans-serif;letter-spacing:.3px}@keyframes _ngcontent-%COMP%_subtleGlow{0%,to{opacity:.6;transform:scale(1)}50%{opacity:.8;transform:scale(1.05)}}@keyframes _ngcontent-%COMP%_blink{0%,50%{opacity:1}51%,to{opacity:.3}}.fecha-navigation[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:20px;padding:16px 20px;background:linear-gradient(135deg,#fff,#f8fafc)!important;border-radius:10px;border:1px solid rgba(34,197,94,.15);box-shadow:0 4px 16px #00000014,0 1px 3px #0000000d,inset 0 1px #ffffffe6;margin-bottom:32px;flex-wrap:wrap;position:relative;overflow:hidden}.fecha-navigation[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,#22c55e,#16a34a,#22c55e);background-size:200% 100%;animation:_ngcontent-%COMP%_shimmer 3s ease-in-out infinite}.fecha-navigation__controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}.fecha-navigation__actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.btn-nav[_ngcontent-%COMP%]{width:44px;height:44px;display:flex;align-items:center;justify-content:center;border-radius:12px;border:1.5px solid var(--border);background:var(--panel-2);cursor:pointer;transition:all .3s cubic-bezier(.4,0,.2,1);font-size:18px;box-shadow:0 2px 8px #0000001a}.btn-nav[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,var(--accent) 0%,#16a34a 100%);border-color:var(--accent);color:#fff;transform:scale(1.1) translateY(-2px);box-shadow:0 6px 16px #22c55e66,inset 0 1px #fff3}.btn-nav[_ngcontent-%COMP%]:active{transform:scale(.95)}.fecha-selector[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.fecha-input[_ngcontent-%COMP%]{padding:10px 16px;border:1px solid var(--border);border-radius:10px;background:var(--panel-2);color:var(--text-1);font-size:14px;font-weight:600;outline:none;cursor:pointer;transition:all .2s ease}.fecha-input[_ngcontent-%COMP%]:focus{border-color:var(--accent);box-shadow:0 0 0 3px #22c55e1a}.resumen-diario[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:20px;margin-bottom:16px}.resumen-card[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:20px;border-radius:16px;border:2px solid;transition:all .4s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden;box-shadow:0 4px 16px #0000001a,inset 0 1px #ffffff0d}.resumen-card[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.1),transparent);transition:left .5s ease}.resumen-card[_ngcontent-%COMP%]:hover{transform:translateY(-6px) scale(1.02);box-shadow:0 12px 32px #0003,inset 0 1px #ffffff1a}.resumen-card[_ngcontent-%COMP%]:hover:before{left:100%}.resumen-card[_ngcontent-%COMP%]:hover   .resumen-card__icon[_ngcontent-%COMP%]{transform:scale(1.15) rotate(5deg)}.resumen-card__icon[_ngcontent-%COMP%]{font-size:42px;transition:all .4s cubic-bezier(.4,0,.2,1);filter:drop-shadow(0 2px 8px rgba(0,0,0,.2));animation:_ngcontent-%COMP%_cardIconFloat 3s ease-in-out infinite}.resumen-card__content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px;flex:1}.resumen-card__label[_ngcontent-%COMP%]{font-size:11px;font-weight:700;color:var(--text-2);text-transform:uppercase;letter-spacing:1px;opacity:.8}.resumen-card__value[_ngcontent-%COMP%]{font-size:32px;font-weight:900;line-height:1;text-shadow:0 2px 8px rgba(0,0,0,.2)}.resumen-card--total[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f626,#3b82f60d);border-color:#3b82f666}.resumen-card--total[_ngcontent-%COMP%]   .resumen-card__value[_ngcontent-%COMP%]{color:#60a5fa;text-shadow:0 0 20px rgba(59,130,246,.5)}.resumen-card--presente[_ngcontent-%COMP%]{background:linear-gradient(135deg,#22c55e26,#22c55e0d);border-color:#22c55e66}.resumen-card--presente[_ngcontent-%COMP%]   .resumen-card__value[_ngcontent-%COMP%]{color:var(--accent);text-shadow:0 0 20px rgba(34,197,94,.5)}.resumen-card--tardanza[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f59e0b26,#f59e0b0d);border-color:#f59e0b66}.resumen-card--tardanza[_ngcontent-%COMP%]   .resumen-card__value[_ngcontent-%COMP%]{color:#fbbf24;text-shadow:0 0 20px rgba(245,158,11,.5)}.resumen-card--falta[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ef444426,#ef44440d);border-color:#ef444466}.resumen-card--falta[_ngcontent-%COMP%]   .resumen-card__value[_ngcontent-%COMP%]{color:#f87171;text-shadow:0 0 20px rgba(239,68,68,.5)}.resumen-card--permiso[_ngcontent-%COMP%]{background:linear-gradient(135deg,#a855f726,#a855f70d);border-color:#a855f766}.resumen-card--permiso[_ngcontent-%COMP%]   .resumen-card__value[_ngcontent-%COMP%]{color:#c084fc;text-shadow:0 0 20px rgba(168,85,247,.5)}.resumen-card--licencia[_ngcontent-%COMP%]{background:linear-gradient(135deg,#0ea5e926,#0ea5e90d);border-color:#0ea5e966}.resumen-card--licencia[_ngcontent-%COMP%]   .resumen-card__value[_ngcontent-%COMP%]{color:#38bdf8;text-shadow:0 0 20px rgba(14,165,233,.5)}.resumen-card--asistencia[_ngcontent-%COMP%]{background:linear-gradient(135deg,#22c55e26,#22c55e0d);border-color:#22c55e66}.resumen-card--asistencia[_ngcontent-%COMP%]   .resumen-card__value[_ngcontent-%COMP%]{color:var(--accent);font-size:32px;text-shadow:0 0 20px rgba(34,197,94,.5)}@keyframes _ngcontent-%COMP%_cardIconFloat{0%,to{transform:translateY(0)}50%{transform:translateY(-4px)}}.filtros-bar[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:16px;padding:16px 20px;background:linear-gradient(135deg,#fff,#f8fafc)!important;border-radius:8px;border:1px solid var(--border);box-shadow:0 4px 16px #00000014,0 1px 3px #0000000d,inset 0 1px #ffffffe6;margin-bottom:16px;flex-wrap:wrap;position:relative;overflow:hidden}.filtros-bar__left[_ngcontent-%COMP%], .filtros-bar__right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;flex-wrap:wrap}.search-box[_ngcontent-%COMP%]{position:relative;min-width:300px}.search-box__icon[_ngcontent-%COMP%]{position:absolute;left:14px;top:50%;transform:translateY(-50%);font-size:18px;opacity:.5;pointer-events:none}.search-box__input[_ngcontent-%COMP%]{width:100%;padding:10px 14px 10px 44px;border:1px solid var(--border);border-radius:10px;background:var(--panel-2);color:var(--text-1);font-size:14px;outline:none;transition:all .2s ease}.search-box__input[_ngcontent-%COMP%]:focus{border-color:var(--accent);box-shadow:0 0 0 3px #22c55e1a}.select[_ngcontent-%COMP%]{padding:10px 14px;border:1px solid var(--border);border-radius:10px;background:var(--panel-2);color:var(--text-1);font-size:14px;outline:none;cursor:pointer;transition:all .2s ease}.select[_ngcontent-%COMP%]:focus{border-color:var(--accent);box-shadow:0 0 0 3px #22c55e1a}.tabla-container[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--panel-1) 0%,var(--panel-2) 100%);border-radius:4px;border:1px solid rgba(34,197,94,.15);overflow:visible;margin-bottom:16px;box-shadow:0 8px 32px #00000014,0 0 0 1px #ffffff0d inset;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);position:relative;z-index:1}.tabla-scroll[_ngcontent-%COMP%]{overflow-x:auto}.tabla[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:0;font-size:14px;border-radius:4px;overflow:hidden}.tabla[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:#059669!important;border-bottom:2px solid #047857!important}.tabla[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:16px 20px!important;text-align:left;font-size:12px!important;font-weight:700!important;color:#fff!important;text-transform:uppercase!important;letter-spacing:1px!important;white-space:nowrap;border-right:1px solid rgba(4,120,87,.3)!important;box-shadow:0 1px 3px #04785733!important}.tabla[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child{border-left:none!important;border-top-left-radius:4px!important}.tabla[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child{border-right:none!important;border-top-right-radius:4px!important}.tabla[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--line-soft);transition:background .15s ease}.tabla[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:var(--panel-2)}.tabla[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.highlight[_ngcontent-%COMP%]{background:#ef44440d}.tabla[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child{border-bottom:none}.tabla[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]:first-child{border-bottom-left-radius:4px}.tabla[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]:last-child{border-bottom-right-radius:4px}.tabla[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:14px 12px;color:var(--text-1)}.td-loading[_ngcontent-%COMP%], .td-empty[_ngcontent-%COMP%]{text-align:center;padding:60px 20px}.loading-spinner[_ngcontent-%COMP%]{font-size:16px;color:var(--text-2)}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:12px}.empty-state__icon[_ngcontent-%COMP%]{font-size:48px;opacity:.5}.empty-state__text[_ngcontent-%COMP%]{font-size:16px;color:var(--text-2);margin:0}.trabajador-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.trabajador-info__nombre[_ngcontent-%COMP%]{font-weight:600;color:var(--text-1)}.trabajador-info__cargo[_ngcontent-%COMP%]{font-size:12px;color:var(--text-2)}.td-hora[_ngcontent-%COMP%]{font-family:Courier New,monospace;font-weight:600}.td-hora--retraso[_ngcontent-%COMP%]{color:#f59e0b}.retraso-badge[_ngcontent-%COMP%]{display:inline-block;margin-left:6px;padding:2px 6px;background:#ef444426;border-radius:4px;font-size:11px;color:#ef4444;font-weight:700}.tiempo-trabajado[_ngcontent-%COMP%]{font-weight:600;color:var(--text-1)}.horas-extras[_ngcontent-%COMP%]{display:block;font-size:11px;color:var(--accent);font-weight:600;margin-top:4px}.justificacion-icon[_ngcontent-%COMP%]{font-size:18px}.justificacion-icon--no[_ngcontent-%COMP%]{opacity:.5}.actions-menu[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:6px;position:relative;z-index:1;flex-wrap:wrap}.actions-dropdown[_ngcontent-%COMP%]{position:relative;display:inline-block;z-index:1}.actions-dropdown--open[_ngcontent-%COMP%]{z-index:999999!important;position:relative!important}.actions-dropdown--open[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]{display:block!important;opacity:1!important;visibility:visible!important;transform:translateY(0)!important;pointer-events:all!important;z-index:999999!important;position:fixed!important;background:#111827!important;backdrop-filter:none!important;-webkit-backdrop-filter:none!important}[data-theme=light][_nghost-%COMP%]   .actions-dropdown--open[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%], [data-theme=light]   [_nghost-%COMP%]   .actions-dropdown--open[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]{background:#fff!important}.dropdown-menu[_ngcontent-%COMP%]{position:fixed!important;inset:auto!important;min-width:200px;background:#111827!important;border:2px solid #1f2937;border-radius:12px;box-shadow:0 10px 40px #000,0 0 0 1px #1f2937 inset;z-index:999999!important;display:none;opacity:0;visibility:hidden;transform:translateY(-10px);transition:opacity .2s ease,transform .2s ease,visibility .2s ease;pointer-events:none;overflow:hidden;backdrop-filter:none!important;-webkit-backdrop-filter:none!important;-webkit-opacity:1!important;-moz-opacity:1!important;opacity:1!important}.dropdown-menu[_ngcontent-%COMP%]:before{content:"";position:absolute;top:-2px;left:0;right:0;height:2px;background:linear-gradient(90deg,var(--accent) 0%,var(--accent-light) 100%);z-index:1;pointer-events:none}[data-theme=light][_nghost-%COMP%]   .dropdown-menu[_ngcontent-%COMP%], [data-theme=light]   [_nghost-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]{background:#fff!important;border-color:#e7e5e4;box-shadow:0 10px 40px #000,0 0 0 1px #e7e5e4 inset}.dropdown-item[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;gap:12px;padding:12px 16px;background:#0f1b2d!important;border:none;color:#e5e7eb!important;font-size:14px;font-weight:600;cursor:pointer!important;transition:all .2s ease;text-align:left;position:relative;z-index:100001!important;pointer-events:auto!important;user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-webkit-opacity:1!important;-moz-opacity:1!important;opacity:1!important;background-color:#0f1b2d!important}.dropdown-item[_ngcontent-%COMP%]:hover{background:#111827!important;background-color:#111827!important;color:#22c55e!important;transform:translate(4px);box-shadow:0 2px 8px #000}.dropdown-item[_ngcontent-%COMP%]:active{background:#1f2937!important;background-color:#1f2937!important;transform:translate(2px);box-shadow:0 1px 4px #000}.dropdown-item[_ngcontent-%COMP%]:focus{outline:2px solid var(--accent);outline-offset:-2px;background:#111827!important;background-color:#111827!important}.dropdown-item[_ngcontent-%COMP%]:first-child{border-radius:12px 12px 0 0}.dropdown-item[_ngcontent-%COMP%]:last-child{border-radius:0 0 12px 12px}.dropdown-item__icon[_ngcontent-%COMP%]{font-size:18px;flex-shrink:0;pointer-events:none;width:24px;text-align:center;-webkit-user-select:none;user-select:none;opacity:1!important;-webkit-opacity:1!important;-moz-opacity:1!important;color:inherit!important;display:inline-block}.dropdown-item__text[_ngcontent-%COMP%]{flex:1;pointer-events:none;-webkit-user-select:none;user-select:none;opacity:1!important;-webkit-opacity:1!important;-moz-opacity:1!important;font-weight:600;color:inherit!important;display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}[data-theme=light][_nghost-%COMP%]   .dropdown-item[_ngcontent-%COMP%], [data-theme=light]   [_nghost-%COMP%]   .dropdown-item[_ngcontent-%COMP%]{background:#fff!important;background-color:#fff!important;color:#0c0a09!important}[data-theme=light][_nghost-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:hover, [data-theme=light]   [_nghost-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:hover{background:#f5f5f4!important;background-color:#f5f5f4!important;color:#059669!important}[data-theme=light][_nghost-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:active, [data-theme=light]   [_nghost-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:active{background:#e7e5e4!important;background-color:#e7e5e4!important}[data-theme=light][_nghost-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:focus, [data-theme=light]   [_nghost-%COMP%]   .dropdown-item[_ngcontent-%COMP%]:focus{background:#f5f5f4!important;background-color:#f5f5f4!important}.dropdown-divider[_ngcontent-%COMP%]{height:1px;background:var(--border);margin:4px 0;opacity:.5}.notificacion-container[_ngcontent-%COMP%]{position:fixed;top:20px;right:20px;z-index:10000;max-width:400px;width:100%}.notificacion[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:16px;padding:20px 24px;background:var(--panel);border:2px solid var(--border);border-radius:16px;box-shadow:0 20px 60px #0006,0 0 0 1px #ffffff0d inset;backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);animation:_ngcontent-%COMP%_slideInRight .4s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden}.notificacion[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;width:4px;height:100%;background:var(--accent);transition:all .3s ease}.notificacion--success[_ngcontent-%COMP%]{border-color:#22c55e4d}.notificacion--success[_ngcontent-%COMP%]:before{background:linear-gradient(180deg,#22c55e,#16a34a)}.notificacion--error[_ngcontent-%COMP%]{border-color:#ef44444d}.notificacion--error[_ngcontent-%COMP%]:before{background:linear-gradient(180deg,#ef4444,#dc2626)}.notificacion--warning[_ngcontent-%COMP%]{border-color:#f59e0b4d}.notificacion--warning[_ngcontent-%COMP%]:before{background:linear-gradient(180deg,#f59e0b,#d97706)}.notificacion--info[_ngcontent-%COMP%]{border-color:#3b82f64d}.notificacion--info[_ngcontent-%COMP%]:before{background:linear-gradient(180deg,#3b82f6,#2563eb)}.notificacion--loading[_ngcontent-%COMP%]{border-color:#8b5cf64d}.notificacion--loading[_ngcontent-%COMP%]:before{background:linear-gradient(180deg,#8b5cf6,#7c3aed)}.notificacion__icon[_ngcontent-%COMP%]{font-size:24px;flex-shrink:0;width:32px;height:32px;display:flex;align-items:center;justify-content:center;border-radius:10px;background:var(--bg-2)}.notificacion__content[_ngcontent-%COMP%]{flex:1;min-width:0}.notificacion__titulo[_ngcontent-%COMP%]{font-size:16px;font-weight:700;color:var(--text-1);margin-bottom:4px;line-height:1.4}.notificacion__mensaje[_ngcontent-%COMP%]{font-size:14px;color:var(--text-2);line-height:1.5}.notificacion__palabra-destacada[_ngcontent-%COMP%]{font-weight:800;padding:2px 6px;border-radius:6px;display:inline-block}.notificacion__palabra-destacada--rojo[_ngcontent-%COMP%]{color:#ef4444!important;background:#ef444433!important;text-shadow:0 0 10px rgba(239,68,68,.6);font-weight:900;letter-spacing:.5px}.notificacion__close[_ngcontent-%COMP%]{background:transparent;border:none;color:var(--text-3);font-size:18px;cursor:pointer;padding:4px;border-radius:6px;transition:all .2s ease;flex-shrink:0}.notificacion__close[_ngcontent-%COMP%]:hover{background:var(--bg-2);color:var(--text-1);transform:rotate(90deg)}.spinner[_ngcontent-%COMP%]{width:24px;height:24px;position:relative}.spinner__circle[_ngcontent-%COMP%]{width:100%;height:100%;border:3px solid rgba(139,92,246,.2);border-top-color:#8b5cf6;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_slideInRight{0%{opacity:0;transform:translate(100%)}to{opacity:1;transform:translate(0)}}.modal-overlay[_ngcontent-%COMP%]{position:fixed!important;inset:0!important;width:100vw!important;height:100vh!important;min-width:100vw!important;min-height:100vh!important;max-width:100vw!important;max-height:100vh!important;margin:0!important;padding:20px!important;background:#000000b3!important;backdrop-filter:blur(8px)!important;-webkit-backdrop-filter:blur(8px)!important;z-index:999999!important;display:flex!important;align-items:center!important;justify-content:center!important;pointer-events:all!important;box-sizing:border-box!important}.modal-confirmacion[_ngcontent-%COMP%]{backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);background:#0009;position:fixed;inset:0;z-index:10000;display:flex;align-items:center;justify-content:center;padding:20px}.modal-confirmacion__content[_ngcontent-%COMP%]{max-width:450px;width:90%;background:var(--panel);border:2px solid var(--border);border-radius:20px;box-shadow:0 25px 80px #00000080,0 0 0 1px #ffffff0d inset;overflow:hidden;animation:_ngcontent-%COMP%_scaleIn .3s cubic-bezier(.4,0,.2,1)}.modal-confirmacion__header[_ngcontent-%COMP%]{padding:24px 28px;display:flex;align-items:center;gap:16px;border-bottom:2px solid var(--border)}.modal-confirmacion__header--success[_ngcontent-%COMP%]{background:linear-gradient(135deg,#22c55e1a,#22c55e0d);border-bottom-color:#22c55e4d}.modal-confirmacion__header--danger[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ef44441a,#ef44440d);border-bottom-color:#ef44444d}.modal-confirmacion__header--warning[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f59e0b1a,#f59e0b0d);border-bottom-color:#f59e0b4d}.modal-confirmacion__header--info[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f61a,#3b82f60d);border-bottom-color:#3b82f64d}.modal-confirmacion__icon[_ngcontent-%COMP%]{font-size:32px;width:48px;height:48px;display:flex;align-items:center;justify-content:center;border-radius:12px;background:var(--bg-2);flex-shrink:0}.modal-confirmacion__titulo[_ngcontent-%COMP%]{font-size:20px;font-weight:800;color:var(--text-1);margin:0;flex:1}.modal-confirmacion__body[_ngcontent-%COMP%]{padding:24px 28px}.modal-confirmacion__mensaje[_ngcontent-%COMP%]{font-size:15px;color:var(--text-2);line-height:1.6;margin:0}.modal-confirmacion__mensaje[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:var(--text-1);font-weight:700}.modal-confirmacion__footer[_ngcontent-%COMP%]{padding:20px 28px;display:flex;justify-content:flex-end;gap:12px;border-top:2px solid var(--border);background:var(--bg-2)}@keyframes _ngcontent-%COMP%_scaleIn{0%{opacity:0;transform:scale(.9) translateY(-20px)}to{opacity:1;transform:scale(1) translateY(0)}}.btn-icon[_ngcontent-%COMP%]{width:36px;height:36px;display:flex;align-items:center;justify-content:center;z-index:1;border-radius:10px;border:none;background:transparent;cursor:pointer;font-size:18px;transition:all .3s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden;box-shadow:0 2px 6px #0000001a}.btn-icon[_ngcontent-%COMP%]:before{content:"";position:absolute;top:50%;left:50%;width:0;height:0;border-radius:50%;background:#fff3;transform:translate(-50%,-50%);transition:width .4s ease,height .4s ease}.btn-icon[_ngcontent-%COMP%]:hover{background:var(--panel-2);transform:scale(1.15) translateY(-2px);box-shadow:0 4px 12px #0003}.btn-icon[_ngcontent-%COMP%]:hover:before{width:100px;height:100px}.btn-icon--success[_ngcontent-%COMP%]{background:linear-gradient(135deg,#22c55e33,#22c55e1a);color:#22c55e;border:1px solid rgba(34,197,94,.3)}.btn-icon--success[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#22c55e4d,#22c55e33);box-shadow:0 6px 16px #22c55e66;color:#16a34a}.btn-icon--danger[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ef444433,#ef44441a);color:#ef4444;border:1px solid rgba(239,68,68,.3)}.btn-icon--danger[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#ef44444d,#ef444433);box-shadow:0 6px 16px #ef444466;color:#dc2626}.btn-icon--primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f633,#3b82f61a);color:#3b82f6;border:1px solid rgba(59,130,246,.3)}.btn-icon--primary[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#3b82f64d,#3b82f633);box-shadow:0 6px 16px #3b82f666;color:#2563eb}.btn-icon--warning[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f59e0b33,#f59e0b1a);color:#f59e0b;border:1px solid rgba(245,158,11,.3)}.btn-icon--warning[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#f59e0b4d,#f59e0b33);box-shadow:0 6px 16px #f59e0b66;color:#d97706}.btn-icon--info[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f633,#3b82f61a);color:#3b82f6;border:1px solid rgba(59,130,246,.3)}.btn-icon--info[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#3b82f64d,#3b82f633);box-shadow:0 6px 16px #3b82f666;color:#2563eb}.btn-icon--orange[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f9731633,#f973161a);color:#f97316;border:1px solid rgba(249,115,22,.3)}.btn-icon--orange[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#f973164d,#f9731633);box-shadow:0 6px 16px #f9731666;color:#ea580c}.btn-icon--purple[_ngcontent-%COMP%]{background:linear-gradient(135deg,#a855f733,#a855f71a);color:#a855f7;border:1px solid rgba(168,85,247,.3)}.btn-icon--purple[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#a855f74d,#a855f733);box-shadow:0 6px 16px #a855f766;color:#9333ea}.btn-icon--cyan[_ngcontent-%COMP%]{background:linear-gradient(135deg,#06b6d433,#06b6d41a);color:#06b6d4;border:1px solid rgba(6,182,212,.3)}.btn-icon--cyan[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#06b6d44d,#06b6d433);box-shadow:0 6px 16px #06b6d466;color:#0891b2}.badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:4px;padding:4px 10px;border-radius:6px;font-size:12px;font-weight:600;white-space:nowrap}.badge--presente[_ngcontent-%COMP%]{background:#22c55e26;color:#22c55e;border:1px solid rgba(34,197,94,.3)}.badge--tardanza[_ngcontent-%COMP%]{background:#f59e0b26;color:#f59e0b;border:1px solid rgba(245,158,11,.3)}.badge--falta[_ngcontent-%COMP%]{background:#ef444433!important;color:#ef4444!important;border:1px solid rgba(239,68,68,.4)!important;font-weight:700;box-shadow:0 0 8px #ef444433}.badge--permiso[_ngcontent-%COMP%]{background:#a855f726;color:#a855f7;border:1px solid rgba(168,85,247,.3)}.badge--licencia[_ngcontent-%COMP%]{background:#0ea5e926;color:#0ea5e9;border:1px solid rgba(14,165,233,.3)}.badge--vacaciones[_ngcontent-%COMP%]{background:#3b82f626;color:#3b82f6;border:1px solid rgba(59,130,246,.3)}.badge--comision[_ngcontent-%COMP%]{background:#8b5cf626;color:#8b5cf6;border:1px solid rgba(139,92,246,.3)}.tarjetas-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:24px;margin-bottom:32px}.tarjeta-asistencia[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--panel-1) 0%,var(--panel-2) 100%);border:1px solid var(--border);border-radius:16px;padding:24px;transition:all .4s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden;box-shadow:0 4px 16px #0000001a,inset 0 1px #ffffff0d}.tarjeta-asistencia[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,transparent,rgba(34,197,94,.4),transparent);transform:scaleX(0);transition:transform .4s ease}.tarjeta-asistencia[_ngcontent-%COMP%]:hover{transform:translateY(-6px) scale(1.02);box-shadow:0 12px 32px #0003,inset 0 1px #ffffff1a;border-color:#22c55e4d}.tarjeta-asistencia[_ngcontent-%COMP%]:hover:before{transform:scaleX(1)}.tarjeta-asistencia--falta[_ngcontent-%COMP%]{border-color:#ef444480;background:linear-gradient(135deg,#ef444414,#ef444408)}.tarjeta-asistencia--falta[_ngcontent-%COMP%]:before{background:linear-gradient(90deg,transparent,rgba(239,68,68,.4),transparent)}.tarjeta-asistencia__header[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:space-between;gap:16px;margin-bottom:20px;padding-bottom:16px;border-bottom:1px solid var(--line-soft)}.tarjeta-asistencia__trabajador[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;flex:1}.tarjeta-asistencia__body[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.tarjeta-asistencia__footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-top:16px;padding-top:16px;border-top:1px solid var(--line-soft);flex-wrap:wrap}.footer-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;flex-wrap:wrap}.avatar[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:50%;background:linear-gradient(135deg,var(--accent) 0%,#16a34a 100%);color:#fff;display:flex;align-items:center;justify-content:center;font-size:20px;font-weight:700}.info[_ngcontent-%COMP%]{flex:1}.info[_ngcontent-%COMP%]   .nombre[_ngcontent-%COMP%]{font-size:15px;font-weight:700;color:var(--text-1);margin:0 0 4px}.info[_ngcontent-%COMP%]   .cargo[_ngcontent-%COMP%], .info[_ngcontent-%COMP%]   .area[_ngcontent-%COMP%]{font-size:12px;color:var(--text-2);margin:0}.marcacion-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}.marcacion-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px;padding:12px;background:var(--panel-2);border-radius:8px}.marcacion-item__label[_ngcontent-%COMP%]{font-size:11px;color:var(--text-2);font-weight:600}.marcacion-item__hora[_ngcontent-%COMP%]{font-size:18px;font-weight:700;color:var(--text-1);font-family:Courier New,monospace}.estadisticas-grid[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.stat-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:10px 12px;background:#22c55e0d;border:1px solid rgba(34,197,94,.15);border-radius:8px}.stat-item__icon[_ngcontent-%COMP%]{font-size:20px}.stat-item__content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px}.stat-item__label[_ngcontent-%COMP%]{font-size:11px;color:var(--text-2);font-weight:600}.stat-item__value[_ngcontent-%COMP%]{font-size:16px;font-weight:700;color:var(--text-1)}.justificacion-info[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:12px;padding:12px;background:#22c55e14;border:1px solid rgba(34,197,94,.2);border-radius:8px}.justificacion-info__icon[_ngcontent-%COMP%]{font-size:18px;flex-shrink:0}.justificacion-info__content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.justificacion-info__label[_ngcontent-%COMP%]{font-size:11px;color:var(--text-2);font-weight:600}.justificacion-info__texto[_ngcontent-%COMP%]{font-size:13px;color:var(--text-1)}.observaciones-info[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:10px;padding:10px 12px;background:var(--panel-2);border-radius:8px;font-size:13px;color:var(--text-2)}.observaciones-info__icon[_ngcontent-%COMP%]{font-size:16px}.tipo-marcacion[_ngcontent-%COMP%]{font-size:11px;color:var(--text-2);font-weight:600;text-transform:uppercase;letter-spacing:.5px}.form-divider[_ngcontent-%COMP%]{height:1px;background:var(--border);margin:24px 0;opacity:.5}.form-section-title[_ngcontent-%COMP%]{font-size:16px;font-weight:700;color:var(--text-1);margin:0 0 16px;display:flex;align-items:center;gap:8px}.alert[_ngcontent-%COMP%]{padding:16px 20px;border-radius:12px;border:2px solid;margin:16px 0}.alert--info[_ngcontent-%COMP%]{background:#3b82f61a;border-color:#3b82f64d;color:var(--text-1)}.alert--info[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#3b82f6;font-weight:700}.alert--info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:8px 0 0;line-height:1.5;color:var(--text-2)}.modal__content--large[_ngcontent-%COMP%]{max-width:600px;width:90%}.modal[_ngcontent-%COMP%]{position:fixed;inset:0;background:#0b1220d9;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);display:flex;align-items:center;justify-content:center;z-index:1000;padding:20px;animation:_ngcontent-%COMP%_fadeIn .2s ease}.modal__content[_ngcontent-%COMP%]{background:var(--panel);border:1px solid var(--border);border-radius:16px;max-width:600px;width:100%;max-height:90vh;overflow-y:auto;box-shadow:0 20px 60px #0000004d;animation:_ngcontent-%COMP%_slideUp .3s ease}.modal__header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:16px;padding:24px;border-bottom:1px solid var(--border)}.modal__title[_ngcontent-%COMP%]{font-size:20px;font-weight:700;color:var(--text-1);margin:0}.modal__close[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:8px;border:none;background:transparent;cursor:pointer;font-size:18px;transition:all .2s ease}.modal__close[_ngcontent-%COMP%]:hover{background:#ef44441a;color:#ef4444}.modal__body[_ngcontent-%COMP%]{padding:24px}.modal__info[_ngcontent-%COMP%]{font-size:14px;color:var(--text-2);margin:0 0 20px}.modal__footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end;gap:12px;padding:20px 24px;border-top:1px solid var(--border)}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.trabajador-selected[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:16px;background:var(--panel-2);border-radius:10px;margin-bottom:24px}.trabajador-selected[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{flex:1}.trabajador-selected[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:16px;font-weight:700;color:var(--text-1);margin:0 0 4px}.trabajador-selected[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:13px;color:var(--text-2);margin:0}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:16px}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px}.form-group--full[_ngcontent-%COMP%]{grid-column:1/-1}.form-label[_ngcontent-%COMP%]{font-size:13px;font-weight:600;color:var(--text-1)}.form-input[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%], .form-textarea[_ngcontent-%COMP%]{padding:10px 12px;border:1px solid var(--border);border-radius:8px;background:var(--panel-2);color:var(--text-1);font-size:14px;outline:none;transition:all .2s ease}.form-input[_ngcontent-%COMP%]:focus, .form-select[_ngcontent-%COMP%]:focus, .form-textarea[_ngcontent-%COMP%]:focus{border-color:var(--accent);box-shadow:0 0 0 3px #22c55e1a}.form-textarea[_ngcontent-%COMP%]{resize:vertical;font-family:inherit}.form-hint[_ngcontent-%COMP%]{font-size:12px;color:var(--text-2);font-style:italic;margin-top:4px}.btn--orange[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f97316,#ea580c);color:#fff}.btn--orange[_ngcontent-%COMP%]:hover{box-shadow:0 0 20px #f9731666;transform:translateY(-1px)}.btn--purple[_ngcontent-%COMP%]{background:linear-gradient(135deg,#a855f7,#9333ea);color:#fff}.btn--purple[_ngcontent-%COMP%]:hover{box-shadow:0 0 20px #a855f766;transform:translateY(-1px)}.btn--cyan[_ngcontent-%COMP%]{background:linear-gradient(135deg,#06b6d4,#0891b2);color:#fff}.btn--cyan[_ngcontent-%COMP%]:hover{box-shadow:0 0 20px #06b6d466;transform:translateY(-1px)}.btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:10px 16px;border-radius:10px;font-weight:600;font-size:14px;cursor:pointer;transition:all .2s ease;border:none;white-space:nowrap}.btn--sm[_ngcontent-%COMP%]{padding:8px 14px;font-size:13px}.btn--primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f6,#2563eb);color:#fff;box-shadow:0 4px 16px #3b82f64d,inset 0 1px #fff3;position:relative;overflow:hidden}.btn--primary[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.3),transparent);transition:left .5s ease}.btn--primary[_ngcontent-%COMP%]:hover{box-shadow:0 6px 20px #3b82f680,inset 0 1px #ffffff4d;transform:translateY(-2px)}.btn--primary[_ngcontent-%COMP%]:hover:before{left:100%}.btn--accent[_ngcontent-%COMP%]{background:linear-gradient(135deg,#22c55e,#16a34a);color:#fff;box-shadow:0 4px 16px #22c55e4d,inset 0 1px #fff3;position:relative;overflow:hidden}.btn--accent[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.3),transparent);transition:left .5s ease}.btn--accent[_ngcontent-%COMP%]:hover{box-shadow:0 6px 20px #22c55e80,inset 0 1px #ffffff4d;transform:translateY(-2px)}.btn--accent[_ngcontent-%COMP%]:hover:before{left:100%}.btn--success[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--accent) 0%,#16a34a 100%);color:#fff;box-shadow:0 4px 16px #22c55e4d,inset 0 1px #fff3;position:relative;overflow:hidden}.btn--success[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.3),transparent);transition:left .5s ease}.btn--success[_ngcontent-%COMP%]:hover{box-shadow:0 6px 20px #22c55e80,inset 0 1px #ffffff4d;transform:translateY(-2px)}.btn--success[_ngcontent-%COMP%]:hover:before{left:100%}.btn--success[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none}.btn--danger[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ef4444,#dc2626);color:#fff;box-shadow:0 4px 16px #ef44444d,inset 0 1px #fff3;position:relative;overflow:hidden}.btn--danger[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.3),transparent);transition:left .5s ease}.btn--danger[_ngcontent-%COMP%]:hover{box-shadow:0 6px 20px #ef444480,inset 0 1px #ffffff4d;transform:translateY(-2px)}.btn--danger[_ngcontent-%COMP%]:hover:before{left:100%}.btn--danger[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none}.btn--outline[_ngcontent-%COMP%]{background:transparent;border:1.5px solid var(--border);color:var(--text-1);position:relative;overflow:hidden}.btn--outline[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;width:0;height:100%;background:var(--accent);transition:width .3s ease;z-index:0}.btn--outline[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{position:relative;z-index:1}.btn--outline[_ngcontent-%COMP%]:hover{background:#22c55e1a;border-color:var(--accent);color:var(--accent)}.btn--outline[_ngcontent-%COMP%]:hover:before{width:100%}.btn--outline.active[_ngcontent-%COMP%]{background:linear-gradient(135deg,#22c55e26,#22c55e1a);border-color:var(--accent);color:var(--accent);box-shadow:0 4px 12px #22c55e33}.btn--ghost[_ngcontent-%COMP%]{background:transparent;border:none;color:var(--text-2)}.btn--ghost[_ngcontent-%COMP%]:hover{background:var(--panel-2);color:var(--text-1)}@media (max-width: 1200px){.resumen-diario[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(160px,1fr))}.tarjetas-container[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(300px,1fr))}}@media (max-width: 768px){.page-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.reloj-digital[_ngcontent-%COMP%]{width:100%;align-items:center}.fecha-navigation[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.fecha-navigation__controls[_ngcontent-%COMP%], .fecha-navigation__actions[_ngcontent-%COMP%]{width:100%;justify-content:space-between}.resumen-diario[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}.filtros-bar[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.filtros-bar__left[_ngcontent-%COMP%], .filtros-bar__right[_ngcontent-%COMP%]{width:100%;flex-direction:column}.search-box[_ngcontent-%COMP%]{min-width:100%}.tarjetas-container[_ngcontent-%COMP%], .form-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.btn-icon-export[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;padding:8px;background:transparent;border:1px solid var(--border);border-radius:8px;cursor:pointer;transition:all .2s ease;box-shadow:0 2px 8px #0000001a;overflow:hidden;min-width:60px}.btn-icon-export__icon[_ngcontent-%COMP%]{width:44px;height:44px;object-fit:contain;transition:all .4s cubic-bezier(.34,1.56,.64,1);position:relative;z-index:2;flex-shrink:0}.btn-icon-export__text[_ngcontent-%COMP%]{position:absolute;left:50%;transform:translate(-50%) translate(30px);font-size:13px;font-weight:600;white-space:nowrap;opacity:0;visibility:hidden;pointer-events:none;transition:all .4s cubic-bezier(.34,1.56,.64,1);z-index:1;color:var(--text-1)}.btn-icon-export[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #00000026}.btn-icon-export[_ngcontent-%COMP%]:hover   .btn-icon-export__icon[_ngcontent-%COMP%]{transform:translate(-45px) scale(1.1);opacity:.2}.btn-icon-export[_ngcontent-%COMP%]:hover   .btn-icon-export__text[_ngcontent-%COMP%]{opacity:1;visibility:visible;transform:translate(-50%);transition-delay:.1s}.btn-icon-export[_ngcontent-%COMP%]:first-child:hover{border-color:#217346}.btn-icon-export[_ngcontent-%COMP%]:first-child:hover   .btn-icon-export__text[_ngcontent-%COMP%]{color:#217346}.btn-icon-export[_ngcontent-%COMP%]:last-child:hover{border-color:#dc143c}.btn-icon-export[_ngcontent-%COMP%]:last-child:hover   .btn-icon-export__text[_ngcontent-%COMP%]{color:#dc143c}'],data:{animation:[Z("slideInOut",[B(":enter",[L({opacity:0,transform:"translateX(100%)"}),W("0.4s cubic-bezier(0.4, 0, 0.2, 1)",L({opacity:1,transform:"translateX(0)"}))]),B(":leave",[W("0.3s cubic-bezier(0.4, 0, 0.2, 1)",L({opacity:0,transform:"translateX(100%)"}))])]),Z("scaleInOut",[B(":enter",[L({opacity:0,transform:"scale(0.9) translateY(-20px)"}),W("0.3s cubic-bezier(0.4, 0, 0.2, 1)",L({opacity:1,transform:"scale(1) translateY(0)"}))]),B(":leave",[W("0.2s cubic-bezier(0.4, 0, 0.2, 1)",L({opacity:0,transform:"scale(0.9) translateY(-20px)"}))])])]}});let l=h;return l})();export{Ft as RegistroComponent};
