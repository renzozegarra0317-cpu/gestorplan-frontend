<!-- frontend/src/app/auth/demo-login-modal/demo-login-modal.component.html -->
<div class="demo-modal-overlay" *ngIf="isVisible" (click)="onBackdropClick($event)">
  <div class="demo-modal-content">
    <!-- Header -->
    <div class="demo-modal-header">
      <div class="demo-header-icon">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M9 11H5a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7a2 2 0 0 0-2-2h-4"/>
          <path d="M9 11V9a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2"/>
          <path d="M9 11l3 3 3-3"/>
        </svg>
      </div>
      <h2 class="demo-modal-title">Acceso Demo</h2>
      <p class="demo-modal-subtitle">Selecciona un usuario DEMO para acceder al sistema</p>
      <button class="demo-close-btn" (click)="cerrarModal()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"/>
          <line x1="6" y1="6" x2="18" y2="18"/>
        </svg>
      </button>
    </div>

    <!-- Body -->
    <div class="demo-modal-body">
      <!-- Información DEMO -->
      <div class="demo-info-box">
        <div class="demo-info-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <path d="M12 16v-4"/>
            <path d="M12 8h.01"/>
          </svg>
        </div>
        <div class="demo-info-content">
          <h4>¿Qué es el Acceso Demo?</h4>
          <p>El acceso DEMO te permite probar todas las funcionalidades del sistema con datos de prueba. Las cuentas DEMO tienen un tiempo limitado de acceso.</p>
        </div>
      </div>

      <!-- Formulario -->
      <form [formGroup]="demoForm" (ngSubmit)="onSubmit()" class="demo-form">
        <!-- Campo Usuario -->
        <div class="form-group">
          <label for="demo-username" class="form-label">
            <svg class="input-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
              <circle cx="12" cy="7" r="4"/>
            </svg>
            Usuario DEMO
          </label>
          <div class="input-container">
            <select
              id="demo-username"
              formControlName="username"
              class="form-select"
              [class.error]="isInvalid('username')"
              (change)="onUserSelect()"
              [disabled]="cargandoUsuarios"
            >
              <option value="">{{ cargandoUsuarios ? 'Cargando usuarios...' : 'Selecciona un usuario DEMO' }}</option>
              <option *ngFor="let user of availableUsers" [value]="user.Username">
                {{ user.Username }} - {{ user.Nombre }} {{ user.Apellidos }}
                <span *ngIf="user.HorasRestantes > 0"> ({{ user.HorasRestantes }}h restantes)</span>
              </option>
            </select>
            <div class="input-focus-border"></div>
          </div>
          <div class="error-message" *ngIf="isInvalid('username')">
            {{ getError('username') }}
          </div>
        </div>

        <!-- Campo Contraseña -->
        <div class="form-group">
          <label for="demo-password" class="form-label">
            <svg class="input-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
              <circle cx="12" cy="16" r="1"/>
              <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
            </svg>
            Contraseña DEMO
          </label>
          <div class="input-container">
            <input
              type="password"
              id="demo-password"
              formControlName="password"
              class="form-input password-input"
              [class.error]="isInvalid('password')"
              placeholder="Ingrese la contraseña del usuario DEMO"
              [disabled]="cargandoUsuarios || !selectedUser"
              autocomplete="new-password"
              data-lpignore="true"
              data-form-type="other"
            >
            <div class="input-focus-border"></div>
          </div>
          <div class="form-hint" *ngIf="selectedUser && selectedUser.HorasRestantes > 0">
            ⏱️ Tiempo restante: {{ selectedUser.HorasRestantes }} hora(s) y {{ selectedUser.MinutosRestantes }} minuto(s)
          </div>
          <div class="error-message" *ngIf="isInvalid('password')">
            {{ getError('password') }}
          </div>
        </div>

        <!-- Usuarios disponibles -->
        <div class="available-users" *ngIf="availableUsers.length > 0">
          <h4>Usuarios DEMO Disponibles:</h4>
          <div class="users-grid">
            <div *ngFor="let user of availableUsers" class="user-card" [class.selected]="selectedUser?.Username === user.Username">
              <div class="user-avatar">
                <span>{{ user.Username.charAt(0).toUpperCase() }}</span>
              </div>
              <div class="user-info">
                <strong>{{ user.Username }}</strong>
                <small>{{ user.Nombre }} {{ user.Apellidos }}</small>
                <small *ngIf="user.HorasRestantes > 0" class="time-remaining">
                  ⏱️ {{ user.HorasRestantes }}h {{ user.MinutosRestantes }}m restantes
                </small>
              </div>
            </div>
          </div>
        </div>
        <div class="no-users-message" *ngIf="!cargandoUsuarios && availableUsers.length === 0">
          <p>⚠️ No hay usuarios DEMO disponibles en este momento. Contacte al administrador.</p>
        </div>

        <!-- Mensaje de error -->
        <div class="alert alert-error" *ngIf="errorMessage">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <line x1="15" y1="9" x2="9" y2="15"/>
            <line x1="9" y1="9" x2="15" y2="15"/>
          </svg>
          {{ errorMessage }}
        </div>
      </form>
    </div>

    <!-- Footer -->
    <div class="demo-modal-footer">
      <button type="button" class="btn btn-secondary" (click)="cerrarModal()" [disabled]="isLoading">
        Cancelar
      </button>
      <button 
        type="button" 
        class="btn btn-primary" 
        (click)="onSubmit()" 
        [disabled]="isLoading || demoForm.invalid"
        [class.loading]="isLoading"
      >
        <span *ngIf="!isLoading">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"/>
            <polyline points="10,17 15,12 10,7"/>
            <line x1="15" y1="12" x2="3" y2="12"/>
          </svg>
          Acceder DEMO
        </span>
        <span *ngIf="isLoading">
          <div class="spinner"></div>
          Iniciando...
        </span>
      </button>
    </div>
  </div>
</div>
